<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LifeInvader Ad Editor</title>
    <style>
        :root {
            --bg-color: #f5f5f5;
            --text-color: #333;
            --container-bg: #fff;
            --border-color: #ddd;
            --primary-color: #4a6fa5;
            --secondary-color: #6c757d;
            --success-color: #28a745;
            --error-color: #dc3545;
            --warning-color: #ffc107;
        }

        [data-theme="dark"] {
            --bg-color: #121212;
            --text-color: #e0e0e0;
            --container-bg: #1e1e1e;
            --border-color: #333;
            --primary-color: #5d8cc9;
            --secondary-color: #8a8a8a;
            --success-color: #34c759;
            --error-color: #ff3b30;
            --warning-color: #ffcc00;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            transition: background-color 0.3s, color 0.3s;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            line-height: 1.6;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: var(--container-bg);
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            padding: 20px;
        }

        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 15px;
        }

        h1 {
            color: var(--primary-color);
            font-size: 1.8rem;
        }

        .theme-toggle {
            background: none;
            border: none;
            color: var(--text-color);
            cursor: pointer;
            font-size: 1.2rem;
            padding: 5px 10px;
            border-radius: 4px;
            border: 1px solid var(--border-color);
        }

        .theme-toggle:hover {
            background-color: var(--border-color);
        }

        .editor-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        @media (max-width: 768px) {
            .editor-container {
                grid-template-columns: 1fr;
            }
        }

        .input-section, .output-section {
            display: flex;
            flex-direction: column;
        }

        h2 {
            margin-bottom: 10px;
            color: var(--primary-color);
            font-size: 1.4rem;
        }

        textarea {
            width: 100%;
            height: 200px;
            padding: 12px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            background-color: var(--container-bg);
            color: var(--text-color);
            font-family: inherit;
            resize: vertical;
        }

        .output-box {
            border: 1px solid var(--border-color);
            border-radius: 4px;
            padding: 12px;
            background-color: var(--container-bg);
            min-height: 200px;
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        .category-box {
            margin-top: 10px;
            padding: 10px;
            border-radius: 4px;
            font-weight: bold;
            text-align: center;
        }

        .category-real-estate { background-color: rgba(40, 167, 69, 0.2); }
        .category-auto { background-color: rgba(0, 123, 255, 0.2); }
        .category-business { background-color: rgba(255, 193, 7, 0.2); }
        .category-work { background-color: rgba(23, 162, 184, 0.2); }
        .category-dating { background-color: rgba(220, 53, 69, 0.2); }
        .category-services { background-color: rgba(111, 66, 193, 0.2); }
        .category-discounts { background-color: rgba(253, 126, 20, 0.2); }
        .category-other { background-color: rgba(108, 117, 125, 0.2); }
        .category-rejected { background-color: rgba(220, 53, 69, 0.3); }

        .button-container {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        button {
            padding: 10px 15px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            transition: background-color 0.2s;
        }

        .format-btn {
            background-color: var(--primary-color);
            color: white;
        }

        .format-btn:hover {
            background-color: #3a5a8c;
        }

        .clear-btn {
            background-color: var(--secondary-color);
            color: white;
        }

        .clear-btn:hover {
            background-color: #5a6268;
        }

        .examples-section {
            margin-top: 30px;
        }

        .examples-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .example-card {
            border: 1px solid var(--border-color);
            border-radius: 4px;
            padding: 15px;
            background-color: var(--container-bg);
            cursor: pointer;
        }

        .example-card:hover {
            background-color: var(--border-color);
        }

        .example-raw {
            font-style: italic;
            margin-bottom: 10px;
            color: var(--secondary-color);
        }

        .example-formatted {
            font-weight: bold;
            margin-bottom: 5px;
        }

        .example-category {
            font-size: 0.8rem;
            color: var(--secondary-color);
        }

        .rejection-reason {
            color: var(--error-color);
            font-weight: bold;
            margin-top: 10px;
        }

        footer {
            margin-top: 30px;
            text-align: center;
            padding-top: 15px;
            border-top: 1px solid var(--border-color);
            color: var(--secondary-color);
            font-size: 0.9rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>LifeInvader Ad Editor</h1>
            <button class="theme-toggle" id="themeToggle">ðŸŒ™ Dark Mode</button>
        </header>

        <div class="editor-container">
            <div class="input-section">
                <h2>Raw Ad Input</h2>
                <textarea id="rawAdInput" placeholder="Paste your raw ad here..."></textarea>
                <div class="button-container">
                    <button class="format-btn" id="formatBtn">Format Ad</button>
                    <button class="clear-btn" id="clearBtn">Clear</button>
                </div>
            </div>

            <div class="output-section">
                <h2>Formatted Ad Output</h2>
                <div class="output-box" id="formattedOutput">Your formatted ad will appear here...</div>
                <div class="category-box" id="categoryOutput"></div>
                <div class="rejection-reason" id="rejectionReason"></div>
            </div>
        </div>

        <div class="examples-section">
            <h2>Example Ads</h2>
            <p>Try these examples to test the formatter:</p>
            <div class="examples-grid" id="examplesGrid">
                <!-- Examples will be populated by JavaScript -->
            </div>
        </div>

        <footer>
            <p>LifeInvader Internal Policy EN-03 | Last updated: 28-04-2025</p>
        </footer>
    </div>

    <script>
        // Theme toggle functionality
        const themeToggle = document.getElementById('themeToggle');
        const body = document.body;

        themeToggle.addEventListener('click', () => {
            if (body.getAttribute('data-theme') === 'dark') {
                body.removeAttribute('data-theme');
                themeToggle.textContent = 'ðŸŒ™ Dark Mode';
            } else {
                body.setAttribute('data-theme', 'dark');
                themeToggle.textContent = 'â˜€ï¸ Light Mode';
            }
        });

        // Format button functionality
        const formatBtn = document.getElementById('formatBtn');
        const clearBtn = document.getElementById('clearBtn');
        const rawAdInput = document.getElementById('rawAdInput');
        const formattedOutput = document.getElementById('formattedOutput');
        const categoryOutput = document.getElementById('categoryOutput');
        const rejectionReason = document.getElementById('rejectionReason');
        const examplesGrid = document.getElementById('examplesGrid');

        // Vehicle database
        const vehicleDatabase = [
            "Adder", "Baller", "Calico GTF", "Declasse Corvette C7", "Elegy Retro Custom", "F620", 
            "Gallivanter Defender", "Hermes", "Imorgon", "Jackal", "Kamacho", "Lampadati Giulia GTA", 
            "Mamba", "Nebula Turbo", "Oracle", "Panto", "Raiden", "Sabre Turbo", "T-20", 
            "Ubermacht 760 (LI)", "V-STR", "Warrener", "X80 Proto", "Yosemite", "Z-Type", "9F",
            "Annis Silvia (S15)", "Annis Skyline GT-R (R34)", "Annis RX-7 (FD)", "Benefactor-MG C63 (W205)",
            "Benefactor-Benz 600SEL (W140)", "Benefactor-Maybach Pullman", "Grotti Italia (F458)",
            "Karin Supra A80", "Karin Tundra 2021", "Truffade Chiron", "Obey R8", "Enus Phantom",
            "Progen 675 LT", "Swift Deluxe", "Frogger", "SuperVolito Carbon", "SeaShark", "Monowheel"
        ];

        // Non-sellable vehicles
        const nonSellableVehicles = [
            "Annis Concept 2021", "Brabus Rocket G900", "Bravado Charger Daytona", "Enus EXP 10",
            "Genesis G90", "KMTA Optima", "Overflod Jesko 2020", "Pfister Cayenne", "Shelby Cobra Daytona",
            "Truffade Centodieci", "Ubermacht M5 (F90)", "Vapid Focus RS", "Benefactor-MG G63 (6X6)"
        ];

        // Clothing database
        const clothingDatabase = [
            "Abibas pants", "Abibas Pezy Boost 700 V3 Alvah shoes", "Lui Vi pants", "Lui Vi full set",
            "TRON full set", "TRON helmet", "Grand RP trousers", "Grand RP collection T-shirt",
            "Grand RP collection pants", "Mikachu hoodie", "The West Pace jacket", "Pans sneakers",
            "Niki Groundporce One new collection shoes", "RGB neon shoes", "Ground Mordan 4 Retro Laser 30th shoes",
            "white tied scarf mask", "black Lui Vi desert scarf mask", "luminous head bag mask"
        ];

        // Example ads data
        const exampleAds = [
            {
                raw: "selling monowheel budget 2.5m",
                formatted: 'Selling "Monowheel". Price: $2.5 Million.',
                category: "Auto"
            },
            {
                raw: "I want to but a penthouse. My budget is 20 mil",
                formatted: "Buying Casino penthouse. Budget: $20 Million.",
                category: "Real Estate"
            },
            {
                raw: "selling house 71 and 1008. Price nego",
                formatted: "Cannot advertise more than 1 property at a time.",
                category: "Rejected",
                rejection: "Cannot advertise more than 1 property at a time."
            },
            {
                raw: "buying a biz. Budget 150 mil",
                formatted: "Buying a private business. Budget: $150 Million.",
                category: "Business"
            },
            {
                raw: "selling state object in city.",
                formatted: "Selling State object business in city. Price: Negotiable.",
                category: "Business"
            },
            {
                raw: "looking Anindo winslow",
                formatted: "Looking for Anindo Winslow.",
                category: "Dating"
            },
            {
                raw: "i am a lawyer, i need work",
                formatted: "Lawyer looking for work.",
                category: "Work"
            },
            {
                raw: "i want to plant solar",
                formatted: "Looking for solar panel plantation work.",
                category: "Work"
            },
            {
                raw: "sell supra, price 10 mil",
                formatted: 'Selling "Karin Supra A80". Price: $10 Million.',
                category: "Auto"
            },
            {
                raw: "buying p1. Budget nego",
                formatted: "Cannot advertise this vehicle is non sellable.",
                category: "Rejected",
                rejection: "Cannot advertise this vehicle is non sellable."
            },
            {
                raw: "party at fib",
                formatted: "Cannot promote parties at FIB.",
                category: "Rejected",
                rejection: "Cannot promote parties at FIB."
            },
            {
                raw: "buying seed bulk. 2500 each",
                formatted: "Buying seeds in bulk. Budget: $2.500 each.",
                category: "Other"
            },
            {
                raw: "sell a rp ticket",
                formatted: "Selling a Grand ticket. Price: Negotiable.",
                category: "Other"
            },
            {
                raw: "buy grand coin",
                formatted: "Cannot promote illegal items.",
                category: "Rejected",
                rejection: "Cannot promote illegal items."
            },
            {
                raw: "i need cocain. 8k each.",
                formatted: "Cannot promote illegal items.",
                category: "Rejected",
                rejection: "Cannot promote illegal items."
            },
            {
                raw: "Selling house 503, garden, 25 garage, swimming pool, custom interior in mirror park. Price : 50 mil",
                formatted: "Selling house â„–503 with a garden, 25 g.s., custom interior and swimming pool in Mirror Park. Price: $50 Million.",
                category: "Real Estate"
            },
            {
                raw: "i have a house for rent, 250k per week",
                formatted: "Renting out a house. Rent: $250.000 per week.",
                category: "Real Estate"
            },
            {
                raw: "buying swift deluxe, price 10 million",
                formatted: 'Buying "Swift Deluxe". Budget: $10 Million.',
                category: "Auto"
            },
            {
                raw: "selling a seashark.",
                formatted: 'Selling "SeaShark". Price: Negotiable.',
                category: "Auto"
            },
            {
                raw: "selling gun store 269 price 500m",
                formatted: "Selling Ammunition Store â„–269. Price: Negotiable.",
                category: "Business"
            },
            {
                raw: "looking to buy juice shop",
                formatted: "Buying Juice shop business. Budget: Negotiable.",
                category: "Business"
            },
            {
                raw: "i need a girlfriend",
                formatted: "Looking for a girlfriend.",
                category: "Dating"
            },
            {
                raw: "selling 20 taxi share",
                formatted: "Selling 20 Taxi fleet shares. Price: Negotiable.",
                category: "Business"
            },
            {
                raw: "buying boys Adidas pant. 80 mil",
                formatted: "Buying Abibas pants for men. Budget: $80 Million.",
                category: "Other"
            },
            {
                raw: "sell 2pcs level 2 engine. 3pcs lvl 2 tire and 2pcs lvl 3 transmission. price 900k, 200k and 300k each.",
                formatted: "Selling 2 medium quality engine, 3 medium quality tires and 2 high quality transmission tunings. Price: $900.000, $200.000 and $300.000 each respectively.",
                category: "Other"
            },
            {
                raw: "selling chiron with max tuning parts, full chip tuning, modification, insurance, turbo and drift kit for 30 million",
                formatted: 'Selling "Truffade Chiron" with full configuration, visual upgrades, insurance, turbo kit and drift kit. Price: $30 Million.',
                category: "Auto"
            },
            {
                raw: "buying a lion. Budget 10 mil",
                formatted: "Buying cage with a Lion Cub. Budget: $10 Million.",
                category: "Other"
            },
            {
                raw: "selling 15 tonic treat. Budget - 90k each",
                formatted: "Selling 15 tonic treats. Price: $90.000 each.",
                category: "Other"
            },
            {
                raw: "Looking for Zandre Mortez",
                formatted: "Looking for Zandre Mortez.",
                category: "Dating"
            },
            {
                raw: "hiring family members.",
                formatted: "Looking for family members.",
                category: "Dating"
            }
        ];

        // Populate examples grid
        exampleAds.forEach(example => {
            const exampleCard = document.createElement('div');
            exampleCard.className = 'example-card';
            
            const rawText = document.createElement('div');
            rawText.className = 'example-raw';
            rawText.textContent = `Raw: ${example.raw}`;
            
            const formattedText = document.createElement('div');
            formattedText.className = 'example-formatted';
            formattedText.textContent = `Formatted: ${example.formatted}`;
            
            const categoryText = document.createElement('div');
            categoryText.className = 'example-category';
            categoryText.textContent = `Category: ${example.category}`;
            
            exampleCard.appendChild(rawText);
            exampleCard.appendChild(formattedText);
            exampleCard.appendChild(categoryText);
            
            // Add click event to populate input
            exampleCard.addEventListener('click', () => {
                rawAdInput.value = example.raw;
                formatAd();
            });
            
            examplesGrid.appendChild(exampleCard);
        });

        // Format ad function
        function formatAd() {
            const rawText = rawAdInput.value.trim();
            if (!rawText) {
                formattedOutput.textContent = "Please enter an ad to format.";
                categoryOutput.textContent = "";
                categoryOutput.className = "category-box";
                rejectionReason.textContent = "";
                return;
            }

            // Process the ad
            const result = processAd(rawText);
            
            // Display results
            formattedOutput.textContent = result.formattedAd;
            categoryOutput.textContent = `Category: ${result.category}`;
            categoryOutput.className = `category-box category-${result.category.toLowerCase().replace(' ', '-')}`;
            
            if (result.rejectionReason) {
                rejectionReason.textContent = `Rejection Reason: ${result.rejectionReason}`;
            } else {
                rejectionReason.textContent = "";
            }
        }

        // Clear function
        function clearAll() {
            rawAdInput.value = "";
            formattedOutput.textContent = "Your formatted ad will appear here...";
            categoryOutput.textContent = "";
            categoryOutput.className = "category-box";
            rejectionReason.textContent = "";
        }

        // Event listeners
        formatBtn.addEventListener('click', formatAd);
        clearBtn.addEventListener('click', clearAll);

        // Process ad according to LifeInvader policy
        function processAd(rawAd) {
            // Convert to lowercase for easier processing
            const lowerAd = rawAd.toLowerCase();
            
            // Check for illegal items first
            const illegalItems = [
                'firearm', 'ammunition', 'bulletproof', 'armor plate', 'weed', 'cannabis', 'cocaine', 'drug',
                'ems mask', 'medical mask', 'covid mask', 'scanner', 'radar', 'balaclava', 'rope', 'head bag',
                'usb with virus', 'lock pick', 'crowbar', 'troll', 'bandit mask', 'animal skin', 'satellite dish',
                'barricade', 'anti-radar', 'engine block', 'air horn', 'grand coin', 'battlepass', 'hype body',
                'gang', 'nationality', 'sale of people', 'sexual', 'birthday', 'playboy family', 'license',
                'mega mall', 'gang hq', 'black market', 'lspd', 'fib', 'sahp', 'ems', 'government', 'ghetto'
            ];
            
            for (const item of illegalItems) {
                if (lowerAd.includes(item)) {
                    return {
                        formattedAd: "Cannot promote illegal items.",
                        category: "Rejected",
                        rejectionReason: "Cannot promote illegal items."
                    };
                }
            }
            
            // Initialize result
            let formattedAd = "";
            let category = "Other";
            let rejectionReason = "";
            
            // Check for buying/selling/trading keywords
            const isBuying = lowerAd.includes('buy') || lowerAd.includes('purchas');
            const isSelling = lowerAd.includes('sell');
            const isTrading = lowerAd.includes('trad');
            const isRenting = lowerAd.includes('rent');
            
            // Determine category and format accordingly
            if (lowerAd.includes('house') || lowerAd.includes('apartment') || lowerAd.includes('penthouse') || lowerAd.includes('mansion')) {
                category = "Real Estate";
                formattedAd = formatRealEstateAd(rawAd, isBuying, isSelling, isRenting);
            } else if (lowerAd.includes('car') || lowerAd.includes('vehicle') || lowerAd.includes('motorcycle') || 
                      lowerAd.includes('bike') || lowerAd.includes('boat') || lowerAd.includes('helicopter') || 
                      lowerAd.includes('plane')) {
                category = "Auto";
                formattedAd = formatAutoAd(rawAd, isBuying, isSelling, isTrading);
            } else if (lowerAd.includes('business') || lowerAd.includes('biz') || lowerAd.includes('store') || 
                      lowerAd.includes('shop') || lowerAd.includes('station') || lowerAd.includes('company')) {
                category = "Business";
                formattedAd = formatBusinessAd(rawAd, isBuying, isSelling, isTrading);
            } else if (lowerAd.includes('work') || lowerAd.includes('job') || lowerAd.includes('hire') || 
                      lowerAd.includes('salary') || lowerAd.includes('construction')) {
                category = "Work";
                formattedAd = formatWorkAd(rawAd, isBuying, isSelling);
            } else if (lowerAd.includes('look') && (lowerAd.includes('for') || lowerAd.includes('dating'))) {
                category = "Dating";
                formattedAd = formatDatingAd(rawAd);
            } else if (lowerAd.includes('discount') || lowerAd.includes('off') || lowerAd.includes('%')) {
                category = "Discounts";
                formattedAd = formatDiscountAd(rawAd);
            } else if (lowerAd.includes('service') || lowerAd.includes('template')) {
                category = "Services";
                formattedAd = formatServiceAd(rawAd);
            } else {
                category = "Other";
                formattedAd = formatOtherAd(rawAd, isBuying, isSelling, isTrading);
            }
            
            // Apply general formatting rules
            formattedAd = applyGeneralFormatting(formattedAd, isBuying, isSelling, isTrading, isRenting);
            
            return {
                formattedAd,
                category,
                rejectionReason
            };
        }

        // Format real estate ads
        function formatRealEstateAd(ad, isBuying, isSelling, isRenting) {
            let formatted = ad;
            
            // Extract house number if mentioned
            const numberMatch = ad.match(/(?:house|apartment|penthouse|mansion)\s*(?:no|number|#)?\s*(\d+)/i);
            const number = numberMatch ? numberMatch[1] : null;
            
            // Standardize terms
            formatted = formatted.replace(/casino apartment/gi, "Casino penthouse");
            formatted = formatted.replace(/garden/gi, "a garden");
            formatted = formatted.replace(/garage space/gi, "g.s.");
            formatted = formatted.replace(/warehouse/gi, "w.h.");
            
            // Apply proper capitalization for locations
            const locations = [
                'Vinewood Hills', 'Rockford Hills', 'Richman', 'Sandy Shores', 'Paleto Bay',
                'Mirror Park', 'Lifeinvader', 'Del Perro', 'Cayo Perico', 'Raton Canyon'
            ];
            
            locations.forEach(location => {
                const regex = new RegExp(location.toLowerCase(), 'gi');
                formatted = formatted.replace(regex, location);
            });
            
            // Add number symbol if number is present
            if (number) {
                formatted = formatted.replace(new RegExp(`(house|apartment|penthouse|mansion)\\s*(?:no|number|#)?\\s*${number}`, 'i'), `$1 â„–${number}`);
            }
            
            return formatted;
        }

        // Format auto ads
        function formatAutoAd(ad, isBuying, isSelling, isTrading) {
            let formatted = ad;
            
            // Extract vehicle name and put in quotes
            const vehicleMatch = ad.match(/(?:selling|buying|trading)\s+([^.,]+?)(?:\s+with|\s+for|\.|$)/i);
            if (vehicleMatch) {
                const vehicleName = vehicleMatch[1].trim();
                // Check if vehicle is in database
                const foundVehicle = vehicleDatabase.find(v => 
                    v.toLowerCase().includes(vehicleName.toLowerCase()) || 
                    vehicleName.toLowerCase().includes(v.toLowerCase())
                );
                
                if (foundVehicle) {
                    // Check if vehicle is non-sellable
                    if (nonSellableVehicles.some(nsv => 
                        nsv.toLowerCase().includes(foundVehicle.toLowerCase()) || 
                        foundVehicle.toLowerCase().includes(nsv.toLowerCase())
                    )) {
                        return {
                            formattedAd: "Cannot advertise this vehicle is non sellable.",
                            category: "Rejected",
                            rejectionReason: "Cannot advertise this vehicle is non sellable."
                        };
                    }
                    
                    formatted = formatted.replace(vehicleName, `"${foundVehicle}"`);
                } else {
                    formatted = formatted.replace(vehicleName, `"${vehicleName}"`);
                }
            }
            
            // Standardize terms
            formatted = formatted.replace(/max config|max tuning|fully upgraded/gi, "with full configuration");
            formatted = formatted.replace(/nearly max|part lvl3|lvl3 or below/gi, "with partial configuration");
            formatted = formatted.replace(/body upgrades|body kit/gi, "with visual upgrades");
            formatted = formatted.replace(/turbo/gi, "turbo kit");
            formatted = formatted.replace(/drift tuning|drift assistance/gi, "drift kit");
            formatted = formatted.replace(/luminous rims|unique wheels/gi, "luminous wheels");
            
            return formatted;
        }

        // Format business ads
        function formatBusinessAd(ad, isBuying, isSelling, isTrading) {
            let formatted = ad;
            
            // Standardize business names
            formatted = formatted.replace(/gun store|weapon store/gi, "Ammunition Store");
            formatted = formatted.replace(/strip club/gi, "Bar");
            formatted = formatted.replace(/barber/gi, "Hair salon");
            formatted = formatted.replace(/charging station/gi, "Electric station");
            formatted = formatted.replace(/drug lab/gi, "Burger shop");
            formatted = formatted.replace(/personal business/gi, "private business");
            
            // Extract business number if mentioned
            const numberMatch = ad.match(/(?:store|shop|station|company)\s*(?:no|number|#)?\s*(\d+)/i);
            const number = numberMatch ? numberMatch[1] : null;
            
            // Add number symbol if number is present
            if (number) {
                formatted = formatted.replace(new RegExp(`(store|shop|station|company)\\s*(?:no|number|#)?\\s*${number}`, 'i'), `$1 â„–${number}`);
            }
            
            return formatted;
        }

        // Format work ads
        function formatWorkAd(ad, isBuying, isSelling) {
            let formatted = ad;
            
            // Standardize terms
            formatted = formatted.replace(/level/gi, "years experience");
            formatted = formatted.replace(/exotic dancers|stripers/gi, "Professional dancer");
            
            // Extract construction site number if mentioned
            const siteMatch = ad.match(/construction site\s*(?:no|number|#)?\s*(\d+)/i);
            const siteNumber = siteMatch ? siteMatch[1] : null;
            
            // Add number symbol if site number is present
            if (siteNumber) {
                formatted = formatted.replace(new RegExp(`construction site\\s*(?:no|number|#)?\\s*${siteNumber}`, 'i'), `construction site â„–${siteNumber}`);
            }
            
            return formatted;
        }

        // Format dating ads
        function formatDatingAd(ad) {
            let formatted = ad;
            
            // Standardize format
            formatted = formatted.replace(/looking to buy|looking to purchase/gi, "Buying");
            formatted = formatted.replace(/looking for/gi, "Looking for");
            
            // Capitalize names (simple implementation)
            const nameMatch = formatted.match(/looking for\s+([a-z]+\s+[a-z]+)/i);
            if (nameMatch) {
                const name = nameMatch[1];
                const capitalizedName = name.split(' ').map(word => 
                    word.charAt(0).toUpperCase() + word.slice(1).toLowerCase()
                ).join(' ');
                formatted = formatted.replace(name, capitalizedName);
            }
            
            return formatted;
        }

        // Format discount ads
        function formatDiscountAd(ad) {
            // For discount ads, we mostly keep the template as is
            return ad;
        }

        // Format service ads
        function formatServiceAd(ad) {
            // For service ads, we mostly keep the template as is
            return ad;
        }

        // Format other ads
        function formatOtherAd(ad, isBuying, isSelling, isTrading) {
            let formatted = ad;
            
            // Standardize terms
            formatted = formatted.replace(/crates|cases/gi, "containers");
            formatted = formatted.replace(/spray cans|spray balloons/gi, "paint cans");
            formatted = formatted.replace(/extras/gi, "of type");
            formatted = formatted.replace(/scarf/gi, "mask");
            formatted = formatted.replace(/pumpkin|cabbage|pineapple|mandarin/gi, "fruits, vegetables or seeds");
            formatted = formatted.replace(/unique 6 rims/gi, "luminous wheels of type 6");
            
            return formatted;
        }

        // Apply general formatting rules
        function applyGeneralFormatting(ad, isBuying, isSelling, isTrading, isRenting) {
            let formatted = ad.trim();
            
            // Capitalize first letter
            formatted = formatted.charAt(0).toUpperCase() + formatted.slice(1);
            
            // Ensure proper ending punctuation
            if (!/[.!?]$/.test(formatted)) {
                formatted += ".";
            }
            
            // Replace price/budget indicators
            if (isBuying) {
                formatted = formatted.replace(/\b(price|cost)\s*:/gi, "Budget:");
                if (!formatted.includes("Budget:")) {
                    formatted = formatted.replace(/(buying[^.]*)\./i, "$1. Budget: Negotiable.");
                }
            } else if (isSelling || isTrading) {
                formatted = formatted.replace(/\b(budget)\s*:/gi, "Price:");
                if (!formatted.includes("Price:") && isSelling) {
                    formatted = formatted.replace(/(selling[^.]*)\./i, "$1. Price: Negotiable.");
                }
            } else if (isRenting) {
                if (formatted.includes("Renting out")) {
                    formatted = formatted.replace(/\b(price|cost)\s*:/gi, "Rent:");
                } else {
                    formatted = formatted.replace(/\b(price|cost)\s*:/gi, "Budget:");
                }
            }
            
            // Format price values
            formatted = formatPriceValues(formatted);
            
            // Replace common abbreviations
            formatted = formatted.replace(/\bnego\b/gi, "Negotiable");
            formatted = formatted.replace(/\bmil\b/gi, "Million");
            
            return formatted;
        }

        // Format price values in the ad
        function formatPriceValues(text) {
            // Format prices like 2.5m, 20k, etc.
            return text.replace(/(?:price|budget|rent)\s*:\s*\$?(\d+(?:\.\d+)?)\s*(mil|million|m|k)(?:\s|\.|$)/gi, (match, amount, unit) => {
                if (unit.toLowerCase() === 'k') {
                    const formattedAmount = (parseFloat(amount) * 1000).toLocaleString();
                    return match.replace(`${amount}${unit}`, `$${formattedAmount}`);
                } else {
                    return match.replace(`${amount}${unit}`, `$${amount} Million`);
                }
            }).replace(/\$?(\d+(?:\.\d+)?)\s*(mil|million|m|k)(?:\s|\.|$)/gi, (match, amount, unit) => {
                if (unit.toLowerCase() === 'k') {
                    const formattedAmount = (parseFloat(amount) * 1000).toLocaleString();
                    return match.replace(`${amount}${unit}`, `$${formattedAmount}`);
                } else {
                    return match.replace(`${amount}${unit}`, `$${amount} Million`);
                }
            });
        }
    </script>
</body>
</html>
