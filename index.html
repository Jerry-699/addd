<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LifeInvader Ad Formatter</title>
    <style>
        :root {
            --bg-color: #1a1a1a;
            --text-color: #e0e0e0;
            --card-bg: #2d2d2d;
            --accent-color: #4a90e2;
            --success-color: #4caf50;
            --warning-color: #ff9800;
            --error-color: #f44336;
            --border-color: #444;
            --input-bg: #3a3a3a;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
        }

        .light-mode {
            --bg-color: #f5f5f5;
            --text-color: #333;
            --card-bg: #fff;
            --accent-color: #2196f3;
            --success-color: #4caf50;
            --warning-color: #ff9800;
            --error-color: #f44336;
            --border-color: #ddd;
            --input-bg: #fff;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            transition: background-color 0.3s, color 0.3s;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            line-height: 1.6;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border-color);
        }

        h1 {
            font-size: 2.2rem;
            color: var(--accent-color);
        }

        .theme-toggle {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            color: var(--text-color);
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 600;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }

        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }

        .card {
            background: var(--card-bg);
            border-radius: 10px;
            padding: 25px;
            box-shadow: var(--shadow);
        }

        h2 {
            margin-bottom: 20px;
            color: var(--accent-color);
            font-size: 1.5rem;
        }

        textarea {
            width: 100%;
            min-height: 200px;
            padding: 15px;
            background: var(--input-bg);
            border: 1px solid var(--border-color);
            border-radius: 5px;
            color: var(--text-color);
            font-family: inherit;
            font-size: 1rem;
            resize: vertical;
        }

        .button-group {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        button {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.2s;
        }

        .primary-btn {
            background: var(--accent-color);
            color: white;
        }

        .secondary-btn {
            background: var(--card-bg);
            color: var(--text-color);
            border: 1px solid var(--border-color);
        }

        button:hover {
            opacity: 0.9;
            transform: translateY(-2px);
        }

        .result-container {
            margin-top: 20px;
        }

        .result {
            background: var(--input-bg);
            border: 1px solid var(--border-color);
            border-radius: 5px;
            padding: 15px;
            min-height: 100px;
            white-space: pre-wrap;
            font-family: monospace;
            font-size: 1rem;
            line-height: 1.5;
        }

        .settings-section {
            margin-top: 40px;
        }

        .settings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .setting-item {
            margin-bottom: 15px;
        }

        .setting-item label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
        }

        .setting-item input, .setting-item select {
            width: 100%;
            padding: 10px;
            background: var(--input-bg);
            border: 1px solid var(--border-color);
            border-radius: 5px;
            color: var(--text-color);
        }

        .custom-items {
            margin-top: 20px;
        }

        .custom-item {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
        }

        .custom-item input {
            flex: 1;
        }

        .custom-item button {
            background: var(--error-color);
            color: white;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: 5px;
            color: white;
            font-weight: 600;
            z-index: 1000;
            opacity: 0;
            transform: translateY(-20px);
            transition: all 0.3s;
        }

        .notification.show {
            opacity: 1;
            transform: translateY(0);
        }

        .notification.success {
            background: var(--success-color);
        }

        .notification.error {
            background: var(--error-color);
        }

        .tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 1px solid var(--border-color);
        }

        .tab {
            padding: 10px 20px;
            cursor: pointer;
            border-bottom: 3px solid transparent;
        }

        .tab.active {
            border-bottom: 3px solid var(--accent-color);
            font-weight: 600;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .examples-section {
            margin-top: 30px;
        }

        .example-item {
            margin-bottom: 15px;
            padding: 15px;
            background: var(--input-bg);
            border-radius: 5px;
            border-left: 4px solid var(--accent-color);
        }

        .example-raw {
            font-weight: 600;
            margin-bottom: 5px;
        }

        .example-result {
            color: var(--success-color);
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>LifeInvader Ad Formatter</h1>
            <button class="theme-toggle" id="themeToggle">Switch to Light Mode</button>
        </header>

        <div class="tabs">
            <div class="tab active" data-tab="formatter">Ad Formatter</div>
            <div class="tab" data-tab="settings">Settings</div>
            <div class="tab" data-tab="examples">Examples</div>
        </div>

        <div class="tab-content active" id="formatter">
            <div class="main-content">
                <div class="card">
                    <h2>Raw Ad Input</h2>
                    <textarea id="rawAd" placeholder="Paste your raw ad here..."></textarea>
                    <div class="button-group">
                        <button class="primary-btn" id="formatBtn">Format Ad</button>
                        <button class="secondary-btn" id="clearBtn">Clear</button>
                    </div>
                </div>

                <div class="card">
                    <h2>Formatted Ad</h2>
                    <div class="result-container">
                        <div class="result" id="formattedAd">Your formatted ad will appear here...</div>
                    </div>
                    <div class="button-group">
                        <button class="primary-btn" id="copyBtn">Copy to Clipboard</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="tab-content" id="settings">
            <div class="card">
                <h2>Customization Settings</h2>
                <div class="settings-grid">
                    <div class="setting-item">
                        <label for="defaultCategory">Default Category</label>
                        <select id="defaultCategory">
                            <option value="auto">Auto</option>
                            <option value="real-estate">Real Estate</option>
                            <option value="business">Business</option>
                            <option value="work">Work</option>
                            <option value="dating">Dating</option>
                            <option value="services">Services</option>
                            <option value="discounts">Discounts</option>
                            <option value="other">Other</option>
                        </select>
                    </div>

                    <div class="setting-item">
                        <label for="priceFormat">Price Format</label>
                        <select id="priceFormat">
                            <option value="negotiable">Negotiable (default)</option>
                            <option value="specific">Use specific prices when provided</option>
                        </select>
                    </div>

                    <div class="setting-item">
                        <label for="autoCapitalize">Auto Capitalize</label>
                        <select id="autoCapitalize">
                            <option value="yes">Yes</option>
                            <option value="no">No</option>
                        </select>
                    </div>

                    <div class="setting-item">
                        <label for="autoPunctuation">Auto Punctuation</label>
                        <select id="autoPunctuation">
                            <option value="yes">Yes</option>
                            <option value="no">No</option>
                        </select>
                    </div>
                </div>

                <div class="custom-items">
                    <h3>Custom Items</h3>
                    <p>Add custom items that should be recognized in ads:</p>
                    <div id="customItemsList">
                        <!-- Custom items will be added here dynamically -->
                    </div>
                    <div class="custom-item">
                        <input type="text" id="newCustomItem" placeholder="Enter new item name">
                        <button class="primary-btn" id="addCustomItem">Add</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="tab-content" id="examples">
            <div class="card">
                <h2>Ad Formatting Examples</h2>
                <div class="examples-section">
                    <div class="example-item">
                        <div class="example-raw">Raw: selling house 71 and 1008. Price nego</div>
                        <div class="example-result">Result: Cannot sell two houses at a time.</div>
                    </div>
                    <div class="example-item">
                        <div class="example-raw">Raw: buying a biz. Budget 150 mil</div>
                        <div class="example-result">Result: Buying a private business. Budget: $150 Million.</div>
                    </div>
                    <div class="example-item">
                        <div class="example-raw">Raw: selling supra, price 10 mil</div>
                        <div class="example-result">Result: Selling "Karin Supra A80". Price: $10 Million.</div>
                    </div>
                    <div class="example-item">
                        <div class="example-raw">Raw: selling chiron with max tuning parts, full chip tuning, modification, insurance, turbo and drift kit for 30 million</div>
                        <div class="example-result">Result: Selling "Truffade Chiron" with full configuration, visual upgrades, insurance, turbo kit and drift kit. Price: $30 Million.</div>
                    </div>
                    <div class="example-item">
                        <div class="example-raw">Raw: buying p1. Budget nego</div>
                        <div class="example-result">Result: Cannot buy P1 car.</div>
                    </div>
                    <div class="example-item">
                        <div class="example-raw">Raw: i need cocain. 8k each.</div>
                        <div class="example-result">Result: Illegal item cannot be bought.</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="notification" id="notification"></div>

    <script>
        // DOM Elements
        const rawAdInput = document.getElementById('rawAd');
        const formattedAdOutput = document.getElementById('formattedAd');
        const formatBtn = document.getElementById('formatBtn');
        const clearBtn = document.getElementById('clearBtn');
        const copyBtn = document.getElementById('copyBtn');
        const themeToggle = document.getElementById('themeToggle');
        const tabs = document.querySelectorAll('.tab');
        const tabContents = document.querySelectorAll('.tab-content');
        const notification = document.getElementById('notification');
        const addCustomItemBtn = document.getElementById('addCustomItem');
        const newCustomItemInput = document.getElementById('newCustomItem');
        const customItemsList = document.getElementById('customItemsList');

        // Data storage
        let customItems = JSON.parse(localStorage.getItem('customItems')) || [];
        let settings = JSON.parse(localStorage.getItem('settings')) || {
            defaultCategory: 'auto',
            priceFormat: 'negotiable',
            autoCapitalize: 'yes',
            autoPunctuation: 'yes'
        };

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            loadSettings();
            renderCustomItems();
            setupEventListeners();
        });

        // Event Listeners
        function setupEventListeners() {
            formatBtn.addEventListener('click', formatAd);
            clearBtn.addEventListener('click', clearInput);
            copyBtn.addEventListener('click', copyToClipboard);
            themeToggle.addEventListener('click', toggleTheme);
            addCustomItemBtn.addEventListener('click', addCustomItem);
            
            // Tab switching
            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    const tabId = tab.getAttribute('data-tab');
                    switchTab(tabId);
                });
            });

            // Settings change listeners
            document.getElementById('defaultCategory').addEventListener('change', saveSettings);
            document.getElementById('priceFormat').addEventListener('change', saveSettings);
            document.getElementById('autoCapitalize').addEventListener('change', saveSettings);
            document.getElementById('autoPunctuation').addEventListener('change', saveSettings);
        }

        // Tab switching
        function switchTab(tabId) {
            tabs.forEach(tab => {
                if (tab.getAttribute('data-tab') === tabId) {
                    tab.classList.add('active');
                } else {
                    tab.classList.remove('active');
                }
            });

            tabContents.forEach(content => {
                if (content.id === tabId) {
                    content.classList.add('active');
                } else {
                    content.classList.remove('active');
                }
            });
        }

        // Theme toggle
        function toggleTheme() {
            document.body.classList.toggle('light-mode');
            if (document.body.classList.contains('light-mode')) {
                themeToggle.textContent = 'Switch to Dark Mode';
            } else {
                themeToggle.textContent = 'Switch to Light Mode';
            }
        }

        // Load settings
        function loadSettings() {
            document.getElementById('defaultCategory').value = settings.defaultCategory;
            document.getElementById('priceFormat').value = settings.priceFormat;
            document.getElementById('autoCapitalize').value = settings.autoCapitalize;
            document.getElementById('autoPunctuation').value = settings.autoPunctuation;
        }

        // Save settings
        function saveSettings() {
            settings.defaultCategory = document.getElementById('defaultCategory').value;
            settings.priceFormat = document.getElementById('priceFormat').value;
            settings.autoCapitalize = document.getElementById('autoCapitalize').value;
            settings.autoPunctuation = document.getElementById('autoPunctuation').value;
            
            localStorage.setItem('settings', JSON.stringify(settings));
            showNotification('Settings saved successfully!', 'success');
        }

        // Custom items management
        function addCustomItem() {
            const itemName = newCustomItemInput.value.trim();
            if (itemName) {
                customItems.push(itemName);
                localStorage.setItem('customItems', JSON.stringify(customItems));
                renderCustomItems();
                newCustomItemInput.value = '';
                showNotification('Custom item added!', 'success');
            }
        }

        function removeCustomItem(index) {
            customItems.splice(index, 1);
            localStorage.setItem('customItems', JSON.stringify(customItems));
            renderCustomItems();
            showNotification('Custom item removed!', 'success');
        }

        function renderCustomItems() {
            customItemsList.innerHTML = '';
            customItems.forEach((item, index) => {
                const itemElement = document.createElement('div');
                itemElement.className = 'custom-item';
                itemElement.innerHTML = `
                    <input type="text" value="${item}" readonly>
                    <button class="remove-btn" data-index="${index}">Remove</button>
                `;
                customItemsList.appendChild(itemElement);
            });

            // Add event listeners to remove buttons
            document.querySelectorAll('.remove-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const index = parseInt(this.getAttribute('data-index'));
                    removeCustomItem(index);
                });
            });
        }

        // Notification system
        function showNotification(message, type = 'success') {
            notification.textContent = message;
            notification.className = `notification ${type} show`;
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        // Clear input
        function clearInput() {
            rawAdInput.value = '';
            formattedAdOutput.textContent = 'Your formatted ad will appear here...';
        }

        // Copy to clipboard
        function copyToClipboard() {
            const text = formattedAdOutput.textContent;
            if (text && text !== 'Your formatted ad will appear here...') {
                navigator.clipboard.writeText(text)
                    .then(() => showNotification('Copied to clipboard!', 'success'))
                    .catch(err => showNotification('Failed to copy: ' + err, 'error'));
            }
        }

        // Main formatting function
        function formatAd() {
            const rawText = rawAdInput.value.trim();
            if (!rawText) {
                showNotification('Please enter an ad to format', 'error');
                return;
            }

            // Process the ad based on the rules
            let formatted = processAd(rawText);
            formattedAdOutput.textContent = formatted;
        }

        // Ad processing logic
        function processAd(rawText) {
            // Convert to lowercase for easier processing
            let text = rawText.toLowerCase();
            
            // Check for illegal items
            if (containsIllegalItems(text)) {
                return "Illegal item cannot be advertised.";
            }
            
            // Determine category and process accordingly
            if (isRealEstateAd(text)) {
                return processRealEstateAd(text);
            } else if (isAutoAd(text)) {
                return processAutoAd(text);
            } else if (isBusinessAd(text)) {
                return processBusinessAd(text);
            } else if (isWorkAd(text)) {
                return processWorkAd(text);
            } else if (isDatingAd(text)) {
                return processDatingAd(text);
            } else if (isServicesAd(text)) {
                return processServicesAd(text);
            } else if (isDiscountsAd(text)) {
                return processDiscountsAd(text);
            } else {
                return processOtherAd(text);
            }
        }

        // Helper functions for ad processing
        function containsIllegalItems(text) {
            const illegalTerms = [
                'cocain', 'weed', 'cannabis', 'firearm', 'gun', 'ammo', 'bulletproof',
                'armor plate', 'ems mask', 'surgical mask', 'covid mask', 'scanner',
                'radar', 'balaclava', 'rope', 'head bag', 'usb with virus', 'lock pick',
                'crowbar', 'troll', 'bandit mask', 'animal skin', 'satellite dish',
                'barricade', 'anti-radar', 'engine block', 'air horn', 'drug', 'grand coin',
                'battlepass', 'hype body', 'branded armor', 'gang', 'nationality'
            ];
            
            return illegalTerms.some(term => text.includes(term));
        }

        function isRealEstateAd(text) {
            return text.includes('house') || text.includes('apartment') || 
                   text.includes('penthouse') || text.includes('mansion') ||
                   text.includes('property') || text.includes('real estate');
        }

        function isAutoAd(text) {
            return text.includes('car') || text.includes('vehicle') || 
                   text.includes('motorcycle') || text.includes('bike') ||
                   text.includes('boat') || text.includes('plane') || 
                   text.includes('helicopter') || text.includes('auto');
        }

        function isBusinessAd(text) {
            return text.includes('business') || text.includes('biz') || 
                   text.includes('store') || text.includes('shop') ||
                   text.includes('station') || text.includes('company');
        }

        function isWorkAd(text) {
            return text.includes('work') || text.includes('job') || 
                   text.includes('hire') || text.includes('hiring') ||
                   text.includes('salary') || text.includes('worker');
        }

        function isDatingAd(text) {
            return text.includes('looking for') || text.includes('searching for') ||
                   text.includes('need girlfriend') || text.includes('need boyfriend') ||
                   text.includes('wife') || text.includes('husband') || 
                   text.includes('family') || text.includes('date');
        }

        function isServicesAd(text) {
            return text.includes('service') || text.includes('template') ||
                   (text.includes('bar') && !text.includes('strip')) ||
                   text.includes('hair salon') || text.includes('taxi');
        }

        function isDiscountsAd(text) {
            return text.includes('discount') || text.includes('off') || 
                   text.includes('%') || text.includes('sale');
        }

        // Category-specific processing functions
        function processRealEstateAd(text) {
            // Extract key information
            let result = '';
            const isBuying = text.includes('buy') || text.includes('purchase');
            const isSelling = text.includes('sell');
            const isRenting = text.includes('rent');
            
            // Extract property number if exists
            const numberMatch = text.match(/(?:№|no|number|#)\s*(\d+)/i);
            const propertyNumber = numberMatch ? numberMatch[1] : null;
            
            // Extract price/budget
            const priceMatch = text.match(/(\d+(?:\.\d+)?)\s*(?:mil|million|m|k|thousand)/i);
            let price = priceMatch ? `$${priceMatch[1]} Million` : 'Negotiable';
            
            // Start building the ad
            if (isRenting) {
                if (text.includes('renting out')) {
                    result = 'Renting out ';
                } else {
                    result = 'Renting ';
                }
            } else if (isBuying) {
                result = 'Buying ';
            } else if (isSelling) {
                result = 'Selling ';
            } else {
                result = 'Selling ';
            }
            
            // Add property type and number
            if (text.includes('apartment')) {
                if (propertyNumber) {
                    result += `apartment №${propertyNumber}`;
                } else {
                    result += 'an apartment';
                }
            } else if (text.includes('penthouse')) {
                if (text.includes('casino')) {
                    result += 'Casino penthouse';
                } else if (propertyNumber) {
                    result += `penthouse №${propertyNumber}`;
                } else {
                    result += 'a penthouse';
                }
            } else if (text.includes('mansion')) {
                if (propertyNumber) {
                    result += `mansion №${propertyNumber}`;
                } else {
                    result += 'a mansion';
                }
            } else {
                if (propertyNumber) {
                    result += `house №${propertyNumber}`;
                } else {
                    result += 'a house';
                }
            }
            
            // Add features
            const features = [];
            if (text.includes('garden')) features.push('a garden');
            if (text.includes('25 garage') || text.includes('25 g.s')) features.push('25 g.s.');
            if (text.includes('9 garage') || text.includes('9 g.s')) features.push('9 g.s.');
            if (text.includes('5 garage') || text.includes('5 g.s')) features.push('5 g.s.');
            if (text.includes('2 garage') || text.includes('2 g.s')) features.push('2 g.s.');
            if (text.includes('warehouse') || text.includes('w.h')) {
                const whMatch = text.match(/(\d+)\s*(?:warehouse|w\.h)/i);
                if (whMatch) features.push(`${whMatch[1]} w.h.`);
            }
            if (text.includes('custom interior') || text.includes('furnished')) features.push('custom interior');
            if (text.includes('insurance')) features.push('insurance');
            if (text.includes('helipad')) features.push('helipad');
            if (text.includes('swimming pool')) features.push('swimming pool');
            if (text.includes('tennis court')) features.push('tennis court');
            if (text.includes('driveway')) features.push('long driveway');
            if (text.includes('backyard')) features.push('spacious backyard');
            if (text.includes('view')) features.push('nice views');
            
            // Add location if specified
            let location = '';
            if (text.includes('vinewood')) location = ' in Vinewood Hills';
            if (text.includes('mirror park')) location = ' in Mirror Park';
            if (text.includes('rockford')) location = ' in Rockford Hills';
            if (text.includes('richman')) location = ' in Richman';
            if (text.includes('sandy shores')) location = ' in Sandy Shores';
            if (text.includes('paleto')) location = ' in Paleto Bay';
            if (text.includes('city')) location = ' in the city';
            if (text.includes('lifeinvader')) location = ' near Lifeinvader';
            if (text.includes('beach')) location = ' near the beach';
            
            // Build the features string
            if (features.length > 0) {
                if (features.length === 1) {
                    result += ` with ${features[0]}`;
                } else {
                    result += ' with ';
                    features.forEach((feature, index) => {
                        if (index === features.length - 1) {
                            result += ` and ${feature}`;
                        } else if (index === 0) {
                            result += feature;
                        } else {
                            result += `, ${feature}`;
                        }
                    });
                }
            }
            
            // Add location
            result += location;
            
            // Add price/rent
            if (isRenting) {
                if (text.includes('per week')) {
                    result += `. Rent: ${price} per week.`;
                } else {
                    result += `. Rent: ${price}.`;
                }
            } else if (isBuying) {
                result += `. Budget: ${price}.`;
            } else {
                result += `. Price: ${price}.`;
            }
            
            return capitalizeFirstLetter(result);
        }

        function processAutoAd(text) {
            // This is a simplified version - in a real implementation, 
            // you would have a comprehensive database of vehicle names
            let result = '';
            const isBuying = text.includes('buy') || text.includes('purchase');
            const isSelling = text.includes('sell');
            const isTrading = text.includes('trade') || text.includes('exchange');
            const isRenting = text.includes('rent');
            
            // Extract vehicle name
            let vehicleName = extractVehicleName(text);
            
            // Extract price/budget
            const priceMatch = text.match(/(\d+(?:\.\d+)?)\s*(?:mil|million|m|k|thousand)/i);
            let price = priceMatch ? `$${priceMatch[1]} Million` : 'Negotiable';
            
            // Start building the ad
            if (isRenting) {
                if (text.includes('renting out')) {
                    result = 'Renting out ';
                } else {
                    result = 'Renting ';
                }
            } else if (isBuying) {
                result = 'Buying ';
            } else if (isSelling && isTrading) {
                result = 'Selling or trading ';
            } else if (isSelling) {
                result = 'Selling ';
            } else if (isTrading) {
                result = 'Trading ';
            } else {
                result = 'Selling ';
            }
            
            // Add vehicle name
            if (vehicleName) {
                result += `"${vehicleName}"`;
            } else {
                if (text.includes('car')) {
                    result += 'a car';
                } else if (text.includes('motorcycle') || text.includes('bike')) {
                    result += 'a motorcycle';
                } else if (text.includes('boat')) {
                    result += 'a boat';
                } else if (text.includes('helicopter')) {
                    result += 'a helicopter';
                } else if (text.includes('plane')) {
                    result += 'a plane';
                } else {
                    result += 'a vehicle';
                }
            }
            
            // Add features
            const features = [];
            if (text.includes('full config') || text.includes('max tuning') || text.includes('fully upgraded')) {
                features.push('full configuration');
            } else if (text.includes('partial config') || text.includes('nearly max')) {
                features.push('partial configuration');
            }
            
            if (text.includes('visual') || text.includes('body upgrade') || text.includes('body kit')) {
                features.push('visual upgrades');
            }
            
            if (text.includes('luminous') || text.includes('unique wheel')) {
                features.push('luminous wheels');
            }
            
            if (text.includes('insurance')) {
                features.push('insurance');
            }
            
            if (text.includes('turbo')) {
                features.push('turbo kit');
            }
            
            if (text.includes('drift')) {
                features.push('drift kit');
            }
            
            // Build the features string
            if (features.length > 0) {
                result += ' with ';
                features.forEach((feature, index) => {
                    if (index === features.length - 1) {
                        result += feature;
                    } else {
                        result += `${feature}, `;
                    }
                });
            }
            
            // Add price/rent/budget
            if (isRenting) {
                result += `. Rent: ${price}.`;
            } else if (isBuying) {
                result += `. Budget: ${price}.`;
            } else if (isTrading && !isSelling) {
                // For pure trading ads, check if there's a target vehicle
                const targetVehicle = extractTargetVehicle(text);
                if (targetVehicle) {
                    result += ` for "${targetVehicle}".`;
                } else {
                    result += `.`;
                }
            } else {
                result += `. Price: ${price}.`;
            }
            
            return capitalizeFirstLetter(result);
        }

        function processBusinessAd(text) {
            let result = '';
            const isBuying = text.includes('buy') || text.includes('purchase');
            const isSelling = text.includes('sell');
            const isTrading = text.includes('trade');
            
            // Extract business type
            let businessType = extractBusinessType(text);
            
            // Extract business number if exists
            const numberMatch = text.match(/(?:№|no|number|#)\s*(\d+)/i);
            const businessNumber = numberMatch ? numberMatch[1] : null;
            
            // Extract price/budget
            const priceMatch = text.match(/(\d+(?:\.\d+)?)\s*(?:mil|million|m)/i);
            let price = priceMatch ? `$${priceMatch[1]} Million` : 'Negotiable';
            
            // Start building the ad
            if (isBuying) {
                result = 'Buying ';
            } else if (isSelling && isTrading) {
                result = 'Selling or trading ';
            } else if (isSelling) {
                result = 'Selling ';
            } else if (isTrading) {
                result = 'Trading ';
            } else {
                result = 'Selling ';
            }
            
            // Add business type and number
            if (businessType) {
                if (businessNumber) {
                    result += `${businessType} №${businessNumber}`;
                } else {
                    result += `${businessType} business`;
                }
            } else {
                if (text.includes('personal business') || text.includes('private business')) {
                    result += 'private business';
                } else if (text.includes('family business')) {
                    result += 'family business';
                } else {
                    result += 'a business';
                }
            }
            
            // Add location if specified
            if (text.includes('city')) result += ' in the city';
            if (text.includes('paleto')) result += ' near Paleto Bay';
            
            // Add price/budget
            if (isBuying) {
                result += `. Budget: ${price}.`;
            } else {
                result += `. Price: ${price}.`;
            }
            
            return capitalizeFirstLetter(result);
        }

        function processWorkAd(text) {
            let result = '';
            const isHiring = text.includes('hire') || text.includes('hiring');
            const isLookingForWork = text.includes('looking for work') || 
                                   text.includes('need work') || 
                                   text.includes('job seeking');
            
            // Extract job type
            let jobType = extractJobType(text);
            
            // Extract location if specified
            let location = '';
            if (text.includes('construction site')) {
                const siteMatch = text.match(/construction site\s*(?:№|no|number|#)\s*(\d+)/i);
                if (siteMatch) {
                    const siteNum = siteMatch[1];
                    if (siteNum === '1') location = ' at construction site №1 on Vespucci Boulevard';
                    else if (siteNum === '2') location = ' at construction site №2 on Calais Avenue';
                    else if (siteNum === '3') location = ' at construction site №3 in Pillbox Hill';
                    else location = ` at construction site №${siteNum}`;
                } else {
                    location = ' at a construction site';
                }
            } else if (text.includes('solar panel')) {
                location = ' for solar panel plantations';
            } else if (text.includes('fire station') || text.includes('firefighter')) {
                location = ' at Fire Station';
            } else if (text.includes('fib')) {
                location = ' at FIB';
            } else if (text.includes('beach market')) {
                location = ' at the beach market';
            } else if (text.includes('tv station')) {
                location = ' at TV station';
            }
            
            // Extract salary/bonus if specified
            let compensation = '';
            const salaryMatch = text.match(/(\d+(?:\.\d+)?)\s*(?:k|thousand)/i);
            if (salaryMatch) {
                compensation = ` Salary: $${salaryMatch[1]}.000.`;
            } else if (text.includes('bonus')) {
                const bonusMatch = text.match(/(\d+(?:\.\d+)?)\s*(?:k|thousand)/i);
                if (bonusMatch) {
                    compensation = ` Awarding $${bonusMatch[1]}.000 bonus.`;
                } else {
                    compensation = ' Awarding bonuses.';
                }
            } else if (text.includes('paying well')) {
                compensation = ' Paying well.';
            } else {
                compensation = ' Salary: Negotiable.';
            }
            
            // Build the ad
            if (isHiring) {
                if (jobType) {
                    result = `Hiring ${jobType}${location}.${compensation}`;
                } else {
                    result = `Hiring workers${location}.${compensation}`;
                }
            } else if (isLookingForWork) {
                if (jobType) {
                    result = `${capitalizeFirstLetter(jobType)} looking for work.`;
                } else {
                    result = 'Looking for work.';
                }
            } else {
                // Default to hiring
                result = `Hiring workers${location}.${compensation}`;
            }
            
            return capitalizeFirstLetter(result);
        }

        function processDatingAd(text) {
            let result = 'Looking for ';
            
            // Extract person name if specified
            const nameMatch = text.match(/looking for\s+([a-z]+\s+[a-z]+)/i);
            if (nameMatch) {
                const name = nameMatch[1];
                // Check if name is in database (simplified)
                if (isNameInDatabase(name)) {
                    result += `${capitalizeName(name)}.`;
                } else {
                    return "Person not found in database. (Person must be in the GRAND RP mail)";
                }
            } else if (text.includes('girlfriend')) {
                result += 'a girlfriend.';
            } else if (text.includes('boyfriend')) {
                result += 'a boyfriend.';
            } else if (text.includes('wife')) {
                result += 'a wife.';
            } else if (text.includes('husband')) {
                result += 'a husband.';
            } else if (text.includes('family') || text.includes('fam')) {
                if (text.includes('member')) {
                    result += 'family members.';
                } else {
                    result += 'a family.';
                }
            } else if (text.includes('friend')) {
                result += 'a friend.';
            } else if (text.includes('casino poker')) {
                result += 'Casino poker players.';
            } else {
                result += 'someone.';
            }
            
            return capitalizeFirstLetter(result);
        }

        function processServicesAd(text) {
            // For services, we would typically use predefined templates
            // This is a simplified version
            return "Service ad template would go here. (Contact LI to create a template)";
        }

        function processDiscountsAd(text) {
            // For discounts, we would typically use predefined templates
            // This is a simplified version
            return "Discount ad template would go here. (Contact LI to create a template)";
        }

        function processOtherAd(text) {
            let result = '';
            const isBuying = text.includes('buy') || text.includes('purchase');
            const isSelling = text.includes('sell');
            const isTrading = text.includes('trade');
            const isLookingFor = text.includes('looking for');
            
            // Extract item information
            let item = extractItem(text);
            
            // Extract price/budget if specified
            let priceInfo = '';
            const priceMatch = text.match(/(\d+(?:\.\d+)?)\s*(?:mil|million|m|k|thousand)/i);
            if (priceMatch) {
                const amount = priceMatch[1];
                if (text.includes('mil') || text.includes('million') || text.includes('m')) {
                    priceInfo = `$${amount} Million`;
                } else if (text.includes('k') || text.includes('thousand')) {
                    priceInfo = `$${amount}.000`;
                } else {
                    priceInfo = `$${amount}`;
                }
            } else {
                priceInfo = 'Negotiable';
            }
            
            // Build the ad
            if (isLookingFor) {
                result = `Looking for ${item}.`;
            } else if (isBuying) {
                result = `Buying ${item}. Budget: ${priceInfo}.`;
            } else if (isSelling && isTrading) {
                result = `Selling or trading ${item}. Price: ${priceInfo}.`;
            } else if (isSelling) {
                result = `Selling ${item}. Price: ${priceInfo}.`;
            } else if (isTrading) {
                result = `Trading ${item}.`;
            } else {
                result = `Selling ${item}. Price: ${priceInfo}.`;
            }
            
            return capitalizeFirstLetter(result);
        }

        // Helper functions
        function extractVehicleName(text) {
            // This is a simplified version - in reality, you'd have a comprehensive list
            const vehicleMatches = [
                { pattern: /supra/i, name: 'Karin Supra A80' },
                { pattern: /chiron/i, name: 'Truffade Chiron' },
                { pattern: /corvette/i, name: 'Declasse Corvette C7' },
                { pattern: /pista/i, name: 'Grotti Pista (F488)' },
                { pattern: /r34/i, name: 'Annis Skyline GT-R (R34)' },
                { pattern: /m3/i, name: 'Ubermacht M3 (G80)' },
                { pattern: /m5/i, name: 'Ubermacht M5 (E34)' },
                { pattern: /c63/i, name: 'Benefactor-AMG C63 Coupe (W205)' },
                { pattern: /toros/i, name: 'Toros' },
                { pattern: /tundra/i, name: 'Karin Tundra 2021' },
                { pattern: /seashark/i, name: 'SeaShark' },
                { pattern: /swift deluxe/i, name: 'Swift Deluxe' }
            ];
            
            for (const match of vehicleMatches) {
                if (match.pattern.test(text)) {
                    return match.name;
                }
            }
            
            return null;
        }

        function extractTargetVehicle(text) {
            // Extract the vehicle being traded for
            const tradeMatch = text.match(/for\s+([^.,]+)/i);
            if (tradeMatch) {
                return extractVehicleName(tradeMatch[1]) || capitalizeFirstLetter(tradeMatch[1].trim());
            }
            return null;
        }

        function extractBusinessType(text) {
            const businessTypes = [
                'Ammunition Store', 'Bar', 'Car wash', 'Chip tuning', 'Clothing shop',
                'Cowshed', 'Electric station', 'Farm', 'Flower shop', 'Freight train',
                'Gas station', 'Hair salon', 'Jewelry store', 'Oil Well', 'Parking',
                'Plantation', 'Car sharing', 'State object', 'Service station',
                '24/7 Store', 'Tattoo studio', 'Taxi company', 'ATM', 'Juice shop',
                'Burger shop', 'Warehouse'
            ];
            
            for (const type of businessTypes) {
                if (text.includes(type.toLowerCase())) {
                    return type;
                }
            }
            
            // Check for aliases
            if (text.includes('gun store') || text.includes('weapon store')) return 'Ammunition Store';
            if (text.includes('strip club')) return 'Bar';
            if (text.includes('barber')) return 'Hair salon';
            if (text.includes('drug lab')) return 'Burger shop';
            if (text.includes('charging station')) return 'Electric station';
            
            return null;
        }

        function extractJobType(text) {
            const jobTypes = [
                'locksmith', 'electrician', 'gardener', 'surveyor', 'driver',
                'trucker', 'lawyer', 'DJ', 'photographer', 'bodyguard',
                'professional dancer', 'personal driver', 'assistant', 'professional singer',
                'firefighter', 'worker'
            ];
            
            for (const job of jobTypes) {
                if (text.includes(job)) {
                    // Handle special cases
                    if (job === 'gardener') return 'farmer';
                    if (job === 'surveyor') return 'oilman';
                    if (job === 'professional dancer' && text.includes('exotic')) return 'professional dancer';
                    return job;
                }
            }
            
            return null;
        }

        function extractItem(text) {
            // This is a simplified version - in reality, you'd have a comprehensive list
            const itemMatches = [
                { pattern: /abibas pants/i, name: 'Abibas pants' },
                { pattern: /lui vi pants/i, name: 'Lui Vi pants' },
                { pattern: /desert scarf mask/i, name: 'desert scarf mask' },
                { pattern: /seeds/i, name: 'seeds' },
                { pattern: /tuning parts/i, name: 'tuning parts' },
                { pattern: /engine tuning/i, name: 'engine tuning' },
                { pattern: /transmission tuning/i, name: 'transmission tuning' },
                { pattern: /suspension tuning/i, name: 'suspension tuning' },
                { pattern: /tires tuning/i, name: 'tires tuning' },
                { pattern: /brakes tuning/i, name: 'brakes tuning' },
                { pattern: /container/i, name: 'containers' },
                { pattern: /ticket/i, name: 'tickets' },
                { pattern: /juice/i, name: 'juices' },
                { pattern: /fruit/i, name: 'fruits' },
                { pattern: /vegetable/i, name: 'vegetables' }
            ];
            
            for (const match of itemMatches) {
                if (match.pattern.test(text)) {
                    return match.name;
                }
            }
            
            // Check custom items
            for (const item of customItems) {
                if (text.includes(item.toLowerCase())) {
                    return item;
                }
            }
            
            return 'items';
        }

        function isNameInDatabase(name) {
            // This is a simplified check - in reality, you'd query a database
            const knownNames = [
                'anindo winslow', 'zandre mortez', 'elite alphax', 
                'lucio escobar', 'sozo jinx', 'kaizer hami'
            ];
            
            return knownNames.includes(name.toLowerCase());
        }

        function capitalizeName(name) {
            return name.split(' ').map(part => 
                part.charAt(0).toUpperCase() + part.slice(1)
            ).join(' ');
        }

        function capitalizeFirstLetter(text) {
            return text.charAt(0).toUpperCase() + text.slice(1);
        }
    </script>
</body>
</html>
