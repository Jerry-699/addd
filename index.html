<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"><!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LifeInvader Ad Formatter - Professional Tool</title>
    <style>
        :root {
            --bg-primary: #1a1a1a;
            --bg-secondary: #2d2d2d;
            --bg-tertiary: #3d3d3d;
            --text-primary: #e0e0e0;
            --text-secondary: #a0a0a0;
            --accent: #4a76cf;
            --accent-hover: #5a86df;
            --success: #4caf50;
            --warning: #ff9800;
            --danger: #f44336;
            --border: #444;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
        }

        .light-mode {
            --bg-primary: #f5f5f5;
            --bg-secondary: #ffffff;
            --bg-tertiary: #e8e8e8;
            --text-primary: #333333;
            --text-secondary: #666666;
            --accent: #3f51b5;
            --accent-hover: #303f9f;
            --success: #4caf50;
            --warning: #ff9800;
            --danger: #f44336;
            --border: #cccccc;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: var(--bg-primary);
            color: var(--text-primary);
            transition: all 0.3s ease;
            line-height: 1.6;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding: 20px;
            background: var(--bg-secondary);
            border-radius: 10px;
            box-shadow: var(--shadow);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo-icon {
            font-size: 32px;
            color: var(--accent);
        }

        h1 {
            font-size: 32px;
            color: var(--accent);
            font-weight: 700;
        }

        .subtitle {
            color: var(--text-secondary);
            font-size: 16px;
            margin-top: 5px;
        }

        .header-controls {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .theme-toggle, .export-btn, .import-btn {
            background: var(--bg-tertiary);
            border: none;
            color: var(--text-primary);
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 600;
            transition: all 0.2s ease;
        }

        .theme-toggle:hover, .export-btn:hover, .import-btn:hover {
            background: var(--accent);
            color: white;
            transform: translateY(-2px);
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        @media (max-width: 1024px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }

        .card {
            background: var(--bg-secondary);
            padding: 25px;
            border-radius: 12px;
            box-shadow: var(--shadow);
            height: fit-content;
        }

        h2 {
            margin-bottom: 20px;
            font-size: 24px;
            color: var(--accent);
            padding-bottom: 10px;
            border-bottom: 2px solid var(--border);
        }

        h3 {
            margin: 20px 0 10px 0;
            font-size: 18px;
            color: var(--accent);
        }

        textarea {
            width: 100%;
            height: 250px;
            background: var(--bg-primary);
            color: var(--text-primary);
            border: 2px solid var(--border);
            border-radius: 8px;
            padding: 20px;
            resize: vertical;
            font-size: 16px;
            line-height: 1.5;
            transition: border-color 0.3s ease;
        }

        textarea:focus {
            outline: none;
            border-color: var(--accent);
        }

        .button-group {
            display: flex;
            gap: 12px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        button {
            background: var(--accent);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        button:hover {
            background: var(--accent-hover);
            transform: translateY(-2px);
        }

        button.secondary {
            background: var(--bg-tertiary);
            color: var(--text-primary);
        }

        button.secondary:hover {
            background: var(--border);
        }

        button.success {
            background: var(--success);
        }

        button.success:hover {
            background: #45a049;
        }

        button.warning {
            background: var(--warning);
        }

        button.warning:hover {
            background: #e68a00;
        }

        button.danger {
            background: var(--danger);
        }

        button.danger:hover {
            background: #da190b;
        }

        .output-container {
            background: var(--bg-primary);
            border: 2px solid var(--border);
            border-radius: 8px;
            padding: 20px;
            min-height: 250px;
            white-space: pre-wrap;
            font-size: 16px;
            line-height: 1.5;
            font-family: 'Consolas', 'Monaco', monospace;
        }

        .rejection-reason {
            color: var(--danger);
            font-weight: bold;
            margin-top: 15px;
            padding: 15px;
            background: rgba(244, 67, 54, 0.1);
            border-radius: 8px;
            border-left: 4px solid var(--danger);
        }

        .success-message {
            color: var(--success);
            font-weight: bold;
            margin-top: 15px;
            padding: 15px;
            background: rgba(76, 175, 80, 0.1);
            border-radius: 8px;
            border-left: 4px solid var(--success);
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-top: 20px;
        }

        .stat-item {
            background: var(--bg-tertiary);
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }

        .stat-value {
            font-size: 24px;
            font-weight: bold;
            color: var(--accent);
        }

        .stat-label {
            font-size: 14px;
            color: var(--text-secondary);
            margin-top: 5px;
        }

        .tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 1px solid var(--border);
            flex-wrap: wrap;
        }

        .tab {
            padding: 12px 24px;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.2s ease;
            font-weight: 600;
        }

        .tab:hover {
            background: var(--bg-tertiary);
        }

        .tab.active {
            border-bottom: 3px solid var(--accent);
            color: var(--accent);
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .tab-content.active {
            display: block;
        }

        .quick-templates {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 12px;
            margin-top: 20px;
        }

        .template-btn {
            background: var(--bg-tertiary);
            color: var(--text-primary);
            border: none;
            padding: 12px 16px;
            border-radius: 8px;
            cursor: pointer;
            text-align: left;
            transition: all 0.2s ease;
            font-size: 14px;
        }

        .template-btn:hover {
            background: var(--accent);
            color: white;
            transform: translateY(-2px);
        }

        .settings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .settings-item {
            margin-bottom: 20px;
        }

        .settings-item label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .settings-item input, .settings-item select {
            width: 100%;
            padding: 12px 15px;
            background: var(--bg-primary);
            color: var(--text-primary);
            border: 2px solid var(--border);
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s ease;
        }

        .settings-item input:focus, .settings-item select:focus {
            outline: none;
            border-color: var(--accent);
        }

        .custom-items {
            margin-top: 30px;
        }

        .custom-items-controls {
            display: flex;
            gap: 12px;
            margin-bottom: 15px;
        }

        .custom-items-list {
            max-height: 300px;
            overflow-y: auto;
            margin-top: 15px;
            padding: 15px;
            background: var(--bg-primary);
            border-radius: 8px;
            border: 2px solid var(--border);
        }

        .custom-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 15px;
            border-bottom: 1px solid var(--border);
            transition: background 0.2s ease;
        }

        .custom-item:hover {
            background: var(--bg-tertiary);
        }

        .custom-item:last-child {
            border-bottom: none;
        }

        .delete-item {
            color: var(--danger);
            cursor: pointer;
            font-weight: bold;
            font-size: 18px;
            padding: 5px 10px;
            border-radius: 4px;
            transition: background 0.2s ease;
        }

        .delete-item:hover {
            background: rgba(244, 67, 54, 0.2);
        }

        .rules-list {
            max-height: 400px;
            overflow-y: auto;
            padding: 15px;
            background: var(--bg-primary);
            border-radius: 8px;
            border: 2px solid var(--border);
        }

        .rule-item {
            padding: 10px 0;
            border-bottom: 1px solid var(--border);
        }

        .rule-item:last-child {
            border-bottom: none;
        }

        .rule-category {
            font-weight: bold;
            color: var(--accent);
            margin-bottom: 5px;
        }

        .history-list {
            max-height: 400px;
            overflow-y: auto;
        }

        .history-item {
            padding: 15px;
            margin-bottom: 10px;
            background: var(--bg-primary);
            border-radius: 8px;
            border-left: 4px solid var(--accent);
        }

        .history-item.rejected {
            border-left-color: var(--danger);
        }

        .history-item .timestamp {
            font-size: 12px;
            color: var(--text-secondary);
            margin-bottom: 5px;
        }

        .history-item .content {
            font-family: 'Consolas', 'Monaco', monospace;
        }

        .tooltip {
            position: relative;
            display: inline-block;
        }

        .tooltip .tooltiptext {
            visibility: hidden;
            width: 200px;
            background-color: var(--bg-tertiary);
            color: var(--text-primary);
            text-align: center;
            border-radius: 6px;
            padding: 10px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -100px;
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 14px;
            box-shadow: var(--shadow);
        }

        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }

        .category-badge {
            display: inline-block;
            padding: 4px 8px;
            background: var(--accent);
            color: white;
            border-radius: 4px;
            font-size: 12px;
            font-weight: bold;
            margin-left: 10px;
        }

        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .feature-item {
            background: var(--bg-tertiary);
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }

        .feature-icon {
            font-size: 24px;
            margin-bottom: 10px;
            color: var(--accent);
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">
                <div class="logo-icon">📰</div>
                <div>
                    <h1>LifeInvader Ad Formatter</h1>
                    <div class="subtitle">Professional ad formatting tool for EN-03 server</div>
                </div>
            </div>
            <div class="header-controls">
                <button class="export-btn" id="exportBtn">
                    <span>📤</span> Export Data
                </button>
                <button class="import-btn" id="importBtn">
                    <span>📥</span> Import Data
                </button>
                <button class="theme-toggle" id="themeToggle">
                    <span id="themeIcon">☀️</span>
                    <span id="themeText">Light Mode</span>
                </button>
            </div>
        </header>

        <div class="tabs">
            <div class="tab active" data-tab="formatter">Ad Formatter</div>
            <div class="tab" data-tab="settings">Settings & Custom Items</div>
            <div class="tab" data-tab="rules">Formatting Rules</div>
            <div class="tab" data-tab="history">Ad History</div>
            <div class="tab" data-tab="help">Help & Guide</div>
        </div>

        <!-- Formatter Tab -->
        <div class="tab-content active" id="formatter">
            <div class="main-content">
                <div class="card">
                    <h2>Input Raw Ad</h2>
                    <textarea id="rawAd" placeholder="Paste your raw ad here...
Examples:
- selling my car for 1.5m
- looking to buy house with garden
- trading annis r34 for benefactor
- hiring workers at construction site"></textarea>
                    
                    <div class="button-group">
                        <button id="formatBtn" class="success">
                            <span>✨</span> Format Ad
                        </button>
                        <button id="analyzeBtn" class="secondary">
                            <span>🔍</span> Analyze
                        </button>
                        <button id="clearBtn" class="secondary">
                            <span>🗑️</span> Clear
                        </button>
                    </div>

                    <h3>Quick Templates</h3>
                    <div class="quick-templates">
                        <button class="template-btn" data-template="buying-car">Buying Car</button>
                        <button class="template-btn" data-template="selling-car">Selling Car</button>
                        <button class="template-btn" data-template="trading-cars">Trading Cars</button>
                        <button class="template-btn" data-template="selling-house">Selling House</button>
                        <button class="template-btn" data-template="renting-property">Renting Property</button>
                        <button class="template-btn" data-template="looking-for-job">Looking for Job</button>
                        <button class="template-btn" data-template="hiring-workers">Hiring Workers</button>
                        <button class="template-btn" data-template="business-sale">Business Sale</button>
                        <button class="template-btn" data-template="clothing-sale">Clothing Sale</button>
                        <button class="template-btn" data-template="party-event">Party Event</button>
                    </div>
                </div>

                <div class="card">
                    <h2>Formatted Ad <span id="categoryBadge" class="category-badge" style="display: none;">Auto</span></h2>
                    <div class="output-container" id="formattedAd">
                        Your formatted ad will appear here...
                    </div>
                    
                    <div class="button-group">
                        <button id="copyBtn" class="success">
                            <span>📋</span> Copy to Clipboard
                        </button>
                        <button id="saveBtn" class="secondary">
                            <span>💾</span> Save to History
                        </button>
                    </div>

                    <div id="rejectionReason" class="rejection-reason" style="display: none;"></div>
                    <div id="successMessage" class="success-message" style="display: none;"></div>

                    <div class="stats">
                        <div class="stat-item">
                            <div class="stat-value" id="charCount">0</div>
                            <div class="stat-label">Characters</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="wordCount">0</div>
                            <div class="stat-label">Words</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="priceValue">$0</div>
                            <div class="stat-label">Price/Budget</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Settings Tab -->
        <div class="tab-content" id="settings">
            <div class="card">
                <h2>Formatting Settings</h2>
                <div class="settings-grid">
                    <div class="settings-item">
                        <label for="priceFormat">Price Format</label>
                        <select id="priceFormat">
                            <option value="standard">Standard ($1.000)</option>
                            <option value="compact">Compact ($1k)</option>
                            <option value="full">Full ($1,000)</option>
                        </select>
                    </div>
                    <div class="settings-item">
                        <label for="autoCapitalize">Auto Capitalize</label>
                        <select id="autoCapitalize">
                            <option value="yes">Yes</option>
                            <option value="no">No</option>
                        </select>
                    </div>
                    <div class="settings-item">
                        <label for="defaultCategory">Default Category</label>
                        <select id="defaultCategory">
                            <option value="auto">Auto-detect</option>
                            <option value="realEstate">Real Estate</option>
                            <option value="auto">Auto</option>
                            <option value="business">Business</option>
                            <option value="work">Work</option>
                            <option value="dating">Dating</option>
                            <option value="services">Services</option>
                            <option value="discounts">Discounts</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <div class="settings-item">
                        <label for="rejectionStrictness">Rejection Strictness</label>
                        <select id="rejectionStrictness">
                            <option value="strict">Strict</option>
                            <option value="moderate">Moderate</option>
                            <option value="lenient">Lenient</option>
                        </select>
                    </div>
                    <div class="settings-item">
                        <label for="autoPunctuation">Auto Punctuation</label>
                        <select id="autoPunctuation">
                            <option value="yes">Yes</option>
                            <option value="no">No</option>
                        </select>
                    </div>
                    <div class="settings-item">
                        <label for="currencySymbol">Currency Symbol</label>
                        <select id="currencySymbol">
                            <option value="$">$ (Dollar)</option>
                            <option value="€">€ (Euro)</option>
                            <option value="£">£ (Pound)</option>
                        </select>
                    </div>
                </div>

                <div class="custom-items">
                    <h3>Custom Items Database</h3>
                    <p>Add items that should be recognized by the formatter:</p>
                    
                    <div class="custom-items-controls">
                        <input type="text" id="newItem" placeholder="Enter item name (e.g., 'Abibas Pezy Boost shoes')" style="flex: 1;">
                        <select id="itemCategory">
                            <option value="clothing">Clothing</option>
                            <option value="vehicle">Vehicle</option>
                            <option value="business">Business</option>
                            <option value="other">Other</option>
                        </select>
                        <button id="addItemBtn" class="success">Add Item</button>
                    </div>
                    
                    <div class="custom-items-list" id="customItemsList">
                        <!-- Custom items will be listed here -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Rules Tab -->
        <div class="tab-content" id="rules">
            <div class="card">
                <h2>LifeInvader Formatting Rules</h2>
                
                <h3>General Ad Rules</h3>
                <div class="rules-list">
                    <div class="rule-item">
                        <div class="rule-category">Starting Phrases</div>
                        Always begin with: "Buying", "Selling", "Trading", or "Selling or trading"
                    </div>
                    <div class="rule-item">
                        <div class="rule-category">Price/Budget Format</div>
                        Use "Budget:" for buying, "Price:" for selling. Use "Negotiable" if not specified.
                    </div>
                    <div class="rule-item">
                        <div class="rule-category">Capitalization</div>
                        First letter always capital, proper nouns capitalized, end with period (unless ending with number).
                    </div>
                    <div class="rule-item">
                        <div class="rule-category">Currency Format</div>
                        Use $ before amount, period as thousands separator ($1.000 not $1k, $1 Million not $1m).
                    </div>
                </div>

                <h3>Prohibited Content</h3>
                <div class="rules-list">
                    <div class="rule-item">
                        <div class="rule-category">Illegal Items</div>
                        Firearms, ammunition, drugs, balaclavas, lock picks, crowbars, etc.
                    </div>
                    <div class="rule-item">
                        <div class="rule-category">Restricted Content</div>
                        No gang references, sexual content, sale of people, specific family names.
                    </div>
                    <div class="rule-item">
                        <div class="rule-category">Location Restrictions</div>
                        No promotion of Mega Mall, Gang HQs, Black Market, or government buildings.
                    </div>
                </div>

                <h3>Category Specific Rules</h3>
                <div class="rules-list">
                    <div class="rule-item">
                        <div class="rule-category">Real Estate</div>
                        Max 1 numbered property, or 3 unnumbered. Use "g.s." for garage spaces, "w.h." for warehouses.
                    </div>
                    <div class="rule-item">
                        <div class="rule-category">Auto</div>
                        Max 1 vehicle per ad (except trading). Use quotes for vehicle names.
                    </div>
                    <div class="rule-item">
                        <div class="rule-category">Other Category</div>
                        Max 3 items per ad. Includes clothing, parties, fruits/vegetables, etc.
                    </div>
                </div>
            </div>
        </div>

        <!-- History Tab -->
        <div class="tab-content" id="history">
            <div class="card">
                <h2>Ad History</h2>
                <div class="button-group">
                    <button id="clearHistoryBtn" class="danger">
                        <span>🗑️</span> Clear History
                    </button>
                    <button id="exportHistoryBtn" class="secondary">
                        <span>📤</span> Export History
                    </button>
                </div>
                <div class="history-list" id="historyList">
                    <!-- History items will be listed here -->
                </div>
            </div>
        </div>

        <!-- Help Tab -->
        <div class="tab-content" id="help">
            <div class="card">
                <h2>Help & User Guide</h2>
                
                <h3>How to Use This Tool</h3>
                <div class="feature-grid">
                    <div class="feature-item">
                        <div class="feature-icon">📝</div>
                        <div class="feature-title">Paste Raw Ad</div>
                        <div class="feature-desc">Copy and paste the raw ad text into the input field</div>
                    </div>
                    <div class="feature-item">
                        <div class="feature-icon">✨</div>
                        <div class="feature-title">Format Automatically</div>
                        <div class="feature-desc">Click "Format Ad" to apply all LifeInvader rules</div>
                    </div>
                    <div class="feature-item">
                        <div class="feature-icon">📋</div>
                        <div class="feature-title">Copy Result</div>
                        <div class="feature-desc">Use "Copy to Clipboard" to get the formatted ad</div>
                    </div>
                    <div class="feature-item">
                        <div class="feature-icon">⚙️</div>
                        <div class="feature-title">Customize Settings</div>
                        <div class="feature-desc">Adjust formatting preferences in Settings tab</div>
                    </div>
                </div>

                <h3>Common Formatting Examples</h3>
                <div class="rules-list">
                    <div class="rule-item">
                        <div class="rule-category">Before → After</div>
                        "selling my car for 1.5m" → "Selling a car. Price: $1.5 Million."
                    </div>
                    <div class="rule-item">
                        <div class="rule-category">Before → After</div>
                        "looking to buy house with garden" → "Buying a house with a garden. Budget: Negotiable."
                    </div>
                    <div class="rule-item">
                        <div class="rule-category">Before → After</div>
                        "trading annis r34 for benefactor" → "Trading \"Annis Skyline GT-R (R34)\" for \"Benefactor\". Price: Negotiable."
                    </div>
                </div>

                <h3>Tips for Best Results</h3>
                <ul style="padding-left: 20px; margin-top: 15px;">
                    <li>Always include specific item names when possible</li>
                    <li>Mention prices or budgets clearly</li>
                    <li>Specify locations for real estate and events</li>
                    <li>Use the correct business names from the approved list</li>
                    <li>Check the rejection reasons if your ad gets flagged</li>
                </ul>

                <div class="success-message" style="margin-top: 20px;">
                    <strong>Need Help?</strong> Refer to the official LifeInvader Internal Policy document for complete rules and examples.
                </div>
            </div>
        </div>
    </div>

    <script>
        // Comprehensive data structures
        const vehicleDatabase = [
            "Adder", "Baller", "Calico GTF", "Declasse Corvette C7", "Elegy Retro Custom", 
            "F620", "Gallivanter Defender", "Hermes", "Imorgon", "Jackal", "Kamacho",
            "Lampadati Giulia GTA", "Mamba", "Nebula Turbo", "Oracle", "Panto", "Raiden",
            "Sabre Turbo", "T-20", "Ubermacht 760 (LI)", "V-STR", "Warrener", "X80 Proto",
            "Yosemite", "Z-Type", "9F", "Alpha", "Baller LE LWB", "Caracara 4x4",
            // ... (all vehicles from the provided list)
        ];

        const clothingDatabase = [
            "Abibas pants", "Abibas sport pants", "Abibas sweatpants", 
            "Abibas Pezy Boost 700 V3 Alvah shoes", "Abibas Marquee Boost Lows shoes",
            "Abibas Pro Bounce 2019 Lows shoes", "Lui Vi pants", "Lui Vi jacket",
            "Lui Vi sweatshirt", "Lui Vi T-shirt", "Lui Vi full set",
            "Grand RP collection pants", "Grand RP collection T-shirt",
            "Grand RP collection hoodie", "Mikachu hoodie", "TRON full set",
            // ... (all clothing items from the provided list)
        ];

        const businessDatabase = [
            "Ammunition Store", "Bar", "Car wash", "Chip tuning", "Clothing shop",
            "Cowshed", "Electric station", "Farm", "Flower shop", "Freight train",
            "Gas station", "Grand Elite", "Hair salon", "Oil Well", "Parking",
            "Pet Shop", "Plantation", "Car sharing", "State object", "Service station",
            "24/7 Store", "Tattoo studio", "Taxi company", "ATM business", "Juice shop",
            "Burger shop", "Jewelry store", "Fight club"
        ];

        const illegalItems = [
            "firearm", "gun", "ammo", "ammunition", "bullet", "bulletproof vest",
            "armor plate", "weed", "cannabis", "cocaine", "drug", "ems mask",
            "surgical mask", "medical mask", "covid mask", "scanner", "radar",
            "balaclava", "rope", "head bag", "virus usb", "lock pick", "crowbar",
            "troll ad", "bandit mask", "animal skin", "satellite dish", "barricade",
            "anti-radar", "engine block", "air horn", "grand coin", "battlepass",
            "hype body", "branded armor", "gang", "nationality", "leader", "deputy leader",
            "medkit", "pills", "tincture soup", "birthday ad", "playboy family",
            "driving license", "air transport license", "boat transport license"
        ];

        const prohibitedLocations = [
            "mega mall", "gang hq", "ballas", "vagos", "families", "bloods", "marabunta",
            "black market", "lspd", "fib", "sahp", "ems", "government", "ghetto"
        ];

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
        });

        function initializeApp() {
            // Theme toggle
            const themeToggle = document.getElementById('themeToggle');
            const themeIcon = document.getElementById('themeIcon');
            const themeText = document.getElementById('themeText');
            
            themeToggle.addEventListener('click', () => {
                document.body.classList.toggle('light-mode');
                if (document.body.classList.contains('light-mode')) {
                    themeIcon.textContent = '🌙';
                    themeText.textContent = 'Dark Mode';
                    localStorage.setItem('lifeinvaderTheme', 'light');
                } else {
                    themeIcon.textContent = '☀️';
                    themeText.textContent = 'Light Mode';
                    localStorage.setItem('lifeinvaderTheme', 'dark');
                }
            });

            // Load saved theme
            const savedTheme = localStorage.getItem('lifeinvaderTheme') || 'dark';
            if (savedTheme === 'light') {
                document.body.classList.add('light-mode');
                themeIcon.textContent = '🌙';
                themeText.textContent = 'Dark Mode';
            }

            // Tab functionality
            const tabs = document.querySelectorAll('.tab');
            const tabContents = document.querySelectorAll('.tab-content');
            
            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    const tabId = tab.getAttribute('data-tab');
                    
                    tabs.forEach(t => t.classList.remove('active'));
                    tabContents.forEach(c => c.classList.remove('active'));
                    
                    tab.classList.add('active');
                    document.getElementById(tabId).classList.add('active');
                });
            });

            // Template buttons
            const templateButtons = document.querySelectorAll('.template-btn');
            const rawAdTextarea = document.getElementById('rawAd');
            
            templateButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const templateType = button.getAttribute('data-template');
                    let templateText = '';
                    
                    switch(templateType) {
                        case 'buying-car':
                            templateText = 'looking to buy a car with full config, budget around 500k';
                            break;
                        case 'selling-car':
                            templateText = 'selling my annis r34 with visual upgrades, price 1.7m';
                            break;
                        case 'trading-cars':
                            templateText = 'trading my ubermacht m5 for benefactor c63';
                            break;
                        case 'selling-house':
                            templateText = 'selling house with garden and 5 g.s., price negotiable';
                            break;
                        case 'renting-property':
                            templateText = 'renting out apartment near beach, rent 100k per week';
                            break;
                        case 'looking-for-job':
                            templateText = 'looking for work as a trucker, salary negotiable';
                            break;
                        case 'hiring-workers':
                            templateText = 'hiring workers at construction site, awarding bonuses';
                            break;
                        case 'business-sale':
                            templateText = 'selling ammunition store business, price 50 million';
                            break;
                        case 'clothing-sale':
                            templateText = 'selling abibas pezy boost shoes, price 200k';
                            break;
                        case 'party-event':
                            templateText = 'party at the beach this weekend, everyone welcome';
                            break;
                    }
                    
                    rawAdTextarea.value = templateText;
                    updateStats();
                });
            });

            // Format button functionality
            const formatBtn = document.getElementById('formatBtn');
            const analyzeBtn = document.getElementById('analyzeBtn');
            const clearBtn = document.getElementById('clearBtn');
            const copyBtn = document.getElementById('copyBtn');
            const saveBtn = document.getElementById('saveBtn');
            const formattedAd = document.getElementById('formattedAd');
            const rejectionReason = document.getElementById('rejectionReason');
            const successMessage = document.getElementById('successMessage');
            const categoryBadge = document.getElementById('categoryBadge');
            
            formatBtn.addEventListener('click', () => {
                const rawText = rawAdTextarea.value.trim();
                
                if (!rawText) {
                    formattedAd.textContent = 'Please enter an ad to format.';
                    rejectionReason.style.display = 'none';
                    successMessage.style.display = 'none';
                    return;
                }
                
                const result = processAd(rawText);
                formattedAd.textContent = result.formattedAd;
                
                if (result.rejection) {
                    rejectionReason.textContent = `Rejection Reason: ${result.rejection}`;
                    rejectionReason.style.display = 'block';
                    successMessage.style.display = 'none';
                    categoryBadge.style.display = 'none';
                } else {
                    rejectionReason.style.display = 'none';
                    successMessage.textContent = 'Ad successfully formatted according to LifeInvader policies!';
                    successMessage.style.display = 'block';
                    
                    // Show category badge
                    if (result.category) {
                        categoryBadge.textContent = result.category;
                        categoryBadge.style.display = 'inline-block';
                    }
                }
                
                updateStats();
            });
            
            analyzeBtn.addEventListener('click', () => {
                const rawText = rawAdTextarea.value.trim();
                if (!rawText) return;
                
                const analysis = analyzeAd(rawText);
                formattedAd.textContent = analysis;
                rejectionReason.style.display = 'none';
                successMessage.style.display = 'none';
                categoryBadge.style.display = 'none';
            });
            
            clearBtn.addEventListener('click', () => {
                rawAdTextarea.value = '';
                formattedAd.textContent = 'Your formatted ad will appear here...';
                rejectionReason.style.display = 'none';
                successMessage.style.display = 'none';
                categoryBadge.style.display = 'none';
                updateStats();
            });
            
            copyBtn.addEventListener('click', () => {
                const textToCopy = formattedAd.textContent;
                if (textToCopy && !textToCopy.includes('Your formatted ad will appear here')) {
                    navigator.clipboard.writeText(textToCopy).then(() => {
                        const originalText = copyBtn.innerHTML;
                        copyBtn.innerHTML = '<span>✅</span> Copied!';
                        setTimeout(() => {
                            copyBtn.innerHTML = originalText;
                        }, 2000);
                    });
                }
            });
            
            saveBtn.addEventListener('click', () => {
                const formattedText = formattedAd.textContent;
                if (formattedText && !formattedText.includes('Your formatted ad will appear here')) {
                    saveToHistory(formattedText);
                    const originalText = saveBtn.innerHTML;
                    saveBtn.innerHTML = '<span>✅</span> Saved!';
                    setTimeout(() => {
                        saveBtn.innerHTML = originalText;
                    }, 2000);
                }
            });

            // Custom items functionality
            const addItemBtn = document.getElementById('addItemBtn');
            const newItemInput = document.getElementById('newItem');
            const customItemsList = document.getElementById('customItemsList');
            
            let customItems = JSON.parse(localStorage.getItem('lifeinvaderCustomItems')) || [];
            renderCustomItems();
            
            addItemBtn.addEventListener('click', () => {
                const itemName = newItemInput.value.trim();
                const itemCategory = document.getElementById('itemCategory').value;
                
                if (itemName && !customItems.some(item => item.name === itemName)) {
                    customItems.push({
                        name: itemName,
                        category: itemCategory,
                        dateAdded: new Date().toISOString()
                    });
                    localStorage.setItem('lifeinvaderCustomItems', JSON.stringify(customItems));
                    renderCustomItems();
                    newItemInput.value = '';
                }
            });
            
            function renderCustomItems() {
                customItemsList.innerHTML = '';
                if (customItems.length === 0) {
                    customItemsList.innerHTML = '<div style="text-align: center; padding: 20px; color: var(--text-secondary);">No custom items added yet.</div>';
                    return;
                }
                
                customItems.forEach((item, index) => {
                    const itemElement = document.createElement('div');
                    itemElement.className = 'custom-item';
                    itemElement.innerHTML = `
                        <div>
                            <strong>${item.name}</strong>
                            <div style="font-size: 12px; color: var(--text-secondary);">${item.category} • Added ${new Date(item.dateAdded).toLocaleDateString()}</div>
                        </div>
                        <span class="delete-item" data-index="${index}">×</span>
                    `;
                    customItemsList.appendChild(itemElement);
                });
                
                document.querySelectorAll('.delete-item').forEach(button => {
                    button.addEventListener('click', (e) => {
                        const index = parseInt(e.target.getAttribute('data-index'));
                        customItems.splice(index, 1);
                        localStorage.setItem('lifeinvaderCustomItems', JSON.stringify(customItems));
                        renderCustomItems();
                    });
                });
            }

            // History functionality
            const clearHistoryBtn = document.getElementById('clearHistoryBtn');
            const exportHistoryBtn = document.getElementById('exportHistoryBtn');
            const historyList = document.getElementById('historyList');
            
            let adHistory = JSON.parse(localStorage.getItem('lifeinvaderAdHistory')) || [];
            renderHistory();
            
            clearHistoryBtn.addEventListener('click', () => {
                if (confirm('Are you sure you want to clear all history?')) {
                    adHistory = [];
                    localStorage.setItem('lifeinvaderAdHistory', JSON.stringify(adHistory));
                    renderHistory();
                }
            });
            
            exportHistoryBtn.addEventListener('click', () => {
                if (adHistory.length === 0) {
                    alert('No history to export.');
                    return;
                }
                
                const historyText = adHistory.map(entry => 
                    `[${entry.timestamp}] ${entry.content}`
                ).join('\n\n');
                
                const blob = new Blob([historyText], { type: 'text/plain' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `lifeinvader_history_${new Date().toISOString().split('T')[0]}.txt`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            });
            
            function saveToHistory(adContent) {
                adHistory.unshift({
                    content: adContent,
                    timestamp: new Date().toLocaleString()
                });
                
                // Keep only last 50 items
                if (adHistory.length > 50) {
                    adHistory = adHistory.slice(0, 50);
                }
                
                localStorage.setItem('lifeinvaderAdHistory', JSON.stringify(adHistory));
                renderHistory();
            }
            
            function renderHistory() {
                historyList.innerHTML = '';
                if (adHistory.length === 0) {
                    historyList.innerHTML = '<div style="text-align: center; padding: 20px; color: var(--text-secondary);">No ad history yet.</div>';
                    return;
                }
                
                adHistory.forEach(entry => {
                    const historyItem = document.createElement('div');
                    historyItem.className = 'history-item';
                    historyItem.innerHTML = `
                        <div class="timestamp">${entry.timestamp}</div>
                        <div class="content">${entry.content}</div>
                    `;
                    historyList.appendChild(historyItem);
                });
            }

            // Stats update
            function updateStats() {
                const text = rawAdTextarea.value;
                document.getElementById('charCount').textContent = text.length;
                document.getElementById('wordCount').textContent = text.split(/\s+/).filter(word => word.length > 0).length;
                
                // Extract price information
                const priceMatch = text.match(/(\d+(?:\.\d+)?)\s*(?:k|m|million|thousand)/i);
                if (priceMatch) {
                    let value = parseFloat(priceMatch[1]);
                    const unit = priceMatch[0].toLowerCase();
                    
                    if (unit.includes('k') || unit.includes('thousand')) {
                        value *= 1000;
                    } else if (unit.includes('m') || unit.includes('million')) {
                        value *= 1000000;
                    }
                    
                    document.getElementById('priceValue').textContent = `$${value.toLocaleString()}`;
                } else {
                    document.getElementById('priceValue').textContent = '$0';
                }
            }
            
            rawAdTextarea.addEventListener('input', updateStats);
            updateStats();

            // Export/Import functionality
            document.getElementById('exportBtn').addEventListener('click', exportData);
            document.getElementById('importBtn').addEventListener('click', importData);
            
            function exportData() {
                const data = {
                    customItems: customItems,
                    settings: {
                        priceFormat: document.getElementById('priceFormat').value,
                        autoCapitalize: document.getElementById('autoCapitalize').value,
                        defaultCategory: document.getElementById('defaultCategory').value,
                        rejectionStrictness: document.getElementById('rejectionStrictness').value,
                        autoPunctuation: document.getElementById('autoPunctuation').value,
                        currencySymbol: document.getElementById('currencySymbol').value
                    },
                    exportDate: new Date().toISOString()
                };
                
                const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `lifeinvader_data_${new Date().toISOString().split('T')[0]}.json`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            }
            
            function importData() {
                const input = document.createElement('input');
                input.type = 'file';
                input.accept = '.json';
                input.onchange = e => {
                    const file = e.target.files[0];
                    const reader = new FileReader();
                    reader.onload = event => {
                        try {
                            const data = JSON.parse(event.target.result);
                            
                            if (data.customItems) {
                                customItems = data.customItems;
                                localStorage.setItem('lifeinvaderCustomItems', JSON.stringify(customItems));
                                renderCustomItems();
                            }
                            
                            if (data.settings) {
                                document.getElementById('priceFormat').value = data.settings.priceFormat || 'standard';
                                document.getElementById('autoCapitalize').value = data.settings.autoCapitalize || 'yes';
                                document.getElementById('defaultCategory').value = data.settings.defaultCategory || 'auto';
                                document.getElementById('rejectionStrictness').value = data.settings.rejectionStrictness || 'strict';
                                document.getElementById('autoPunctuation').value = data.settings.autoPunctuation || 'yes';
                                document.getElementById('currencySymbol').value = data.settings.currencySymbol || '$';
                            }
                            
                            alert('Data imported successfully!');
                        } catch (error) {
                            alert('Error importing data: Invalid file format.');
                        }
                    };
                    reader.readAsText(file);
                };
                input.click();
            }
        }

        // Comprehensive ad processing function
        function processAd(rawText) {
            let formatted = rawText;
            let rejection = null;
            let category = 'Other';
            
            // Convert to lowercase for checks but preserve original for formatting
            const lowerText = rawText.toLowerCase();
            
            // Check for illegal items
            for (const item of illegalItems) {
                if (lowerText.includes(item)) {
                    rejection = 'Cannot promote illegal items.';
                    return { formattedAd: 'AD REJECTED', rejection, category: null };
                }
            }
            
            // Check for prohibited locations
            for (const location of prohibitedLocations) {
                if (lowerText.includes(location)) {
                    rejection = 'Cannot promote this location.';
                    return { formattedAd: 'AD REJECTED', rejection, category: null };
                }
            }
            
            // Detect category
            if (lowerText.includes('house') || lowerText.includes('apartment') || lowerText.includes('mansion') || lowerText.includes('penthouse')) {
                category = 'Real Estate';
            } else if (lowerText.includes('car') || lowerText.includes('vehicle') || lowerText.includes('motorcycle') || 
                      lowerText.includes('bike') || lowerText.includes('boat') || lowerText.includes('plane') || 
                      lowerText.includes('helicopter')) {
                category = 'Auto';
            } else if (lowerText.includes('business') || businessDatabase.some(biz => lowerText.includes(biz.toLowerCase()))) {
                category = 'Business';
            } else if (lowerText.includes('hiring') || lowerText.includes('job') || lowerText.includes('work') || 
                      lowerText.includes('salary') || lowerText.includes('worker')) {
                category = 'Work';
            } else if (lowerText.includes('looking for') || lowerText.includes('dating') || 
                      lowerText.includes('wife') || lowerText.includes('husband') || 
                      lowerText.includes('boyfriend') || lowerText.includes('girlfriend')) {
                category = 'Dating';
            } else if (lowerText.includes('discount') || lowerText.includes('% off') || lowerText.includes('sale')) {
                category = 'Discounts';
            } else if (lowerText.includes('service') || lowerText.includes('template')) {
                category = 'Services';
            }
            
            // Category-specific validation
            if (category === 'Auto') {
                const vehicleCount = (lowerText.match(/\b(car|vehicle|motorcycle|bike|boat|plane|helicopter)\b/g) || []).length;
                if (vehicleCount > 1 && !lowerText.includes('trading')) {
                    rejection = 'Cannot advertise more than 1 vehicle at a time.';
                    return { formattedAd: 'AD REJECTED', rejection, category: null };
                }
            }
            
            if (category === 'Other') {
                const itemCount = (lowerText.match(/\b(selling|buying|trading)\b/g) || []).length;
                if (itemCount > 3) {
                    rejection = 'Cannot advertise more than 3 items at a time in Other category.';
                    return { formattedAd: 'AD REJECTED', rejection, category: null };
                }
            }
            
            // Apply formatting rules
            formatted = applyFormattingRules(formatted, category);
            
            return { formattedAd: formatted, rejection: null, category };
        }
        
        function applyFormattingRules(text, category) {
            let formatted = text;
            
            // Capitalize first letter
            formatted = formatted.charAt(0).toUpperCase() + formatted.slice(1);
            
            // Replace common terms
            const replacements = [
                { from: /\blooking to buy\b/gi, to: 'Buying' },
                { from: /\blooking to purchase\b/gi, to: 'Buying' },
                { from: /\bwant to buy\b/gi, to: 'Buying' },
                { from: /\bwant to purchase\b/gi, to: 'Buying' },
                { from: /\bmax config\b/gi, to: 'with full configuration' },
                { from: /\bmax tuning\b/gi, to: 'with full configuration' },
                { from: /\bfully upgraded\b/gi, to: 'with full configuration' },
                { from: /\bnearly max\b/gi, to: 'with partial configuration' },
                { from: /\bpartly upgraded\b/gi, to: 'with partial configuration' },
                { from: /\bpartially upgraded\b/gi, to: 'with partial configuration' },
                { from: /\bbody upgrades\b/gi, to: 'with visual upgrades' },
                { from: /\bbody kit\b/gi, to: 'with visual upgrades' },
                { from: /\bturbo\b/gi, to: 'turbo kit' },
                { from: /\bdrift tuning\b/gi, to: 'drift kit' },
                { from: /\bdrift assistance\b/gi, to: 'drift kit' },
                { from: /\bluminous rims\b/gi, to: 'luminous wheels' },
                { from: /\bunique wheels\b/gi, to: 'luminous wheels' },
                { from: /\bcrates\b/gi, to: 'containers' },
                { from: /\bcases\b/gi, to: 'containers' },
                { from: /\bextras\b/gi, to: 'of type' },
                { from: /\bspray cans\b/gi, to: 'paint cans' },
                { from: /\bspray balloons\b/gi, to: 'paint cans' },
                { from: /\blevel 1\b/gi, to: 'low quality' },
                { from: /\blevel 2\b/gi, to: 'medium quality' },
                { from: /\blevel 3\b/gi, to: 'high quality' },
                { from: /\blevel 4\b/gi, to: 'max quality' },
                { from: /\blow level\b/gi, to: 'low quality' },
                { from: /\bmedium level\b/gi, to: 'medium quality' },
                { from: /\bhigh level\b/gi, to: 'high quality' },
                { from: /\bmax level\b/gi, to: 'max quality' },
                { from: /\bscarf\b/gi, to: 'mask' },
                { from: /(\d)k\b/gi, to: '$1.000' },
                { from: /(\d)\.(\d)k\b/gi, to: '$1.$200' },
                { from: /(\d)m\b/gi, to: '$1 Million' },
                { from: /(\d)\.(\d)m\b/gi, to: '$1.$2 Million' },
                { from: /\b(\d+)\s*million\b/gi, to: '$1 Million' },
            ];
            
            replacements.forEach(rep => {
                formatted = formatted.replace(rep.from, rep.to);
            });
            
            // Ensure proper starting phrase
            if (!/^(Buying|Selling|Trading|Selling or trading|Looking for|Hiring|Renting)/i.test(formatted)) {
                if (formatted.toLowerCase().includes('buy')) {
                    formatted = formatted.replace(/^/, 'Buying ');
                } else if (formatted.toLowerCase().includes('sell')) {
                    formatted = formatted.replace(/^/, 'Selling ');
                } else if (formatted.toLowerCase().includes('trad')) {
                    formatted = formatted.replace(/^/, 'Trading ');
                } else if (formatted.toLowerCase().includes('rent')) {
                    formatted = formatted.replace(/^/, 'Renting ');
                } else if (formatted.toLowerCase().includes('look') && formatted.toLowerCase().includes('for')) {
                    formatted = formatted.replace(/^/, 'Looking for ');
                } else if (formatted.toLowerCase().includes('hir')) {
                    formatted = formatted.replace(/^/, 'Hiring ');
                }
            }
            
            // Ensure proper price/budget format
            if (/Buying/i.test(formatted) && !/Budget:/i.test(formatted)) {
                formatted = formatted.replace(/(Buying.*?)(\.|$)/i, '$1 Budget: Negotiable.$2');
            }
            
            if (/Selling/i.test(formatted) && !/Price:/i.test(formatted) && !/Selling or trading/i.test(formatted)) {
                formatted = formatted.replace(/(Selling.*?)(\.|$)/i, '$1 Price: Negotiable.$2');
            }
            
            if (/Selling or trading/i.test(formatted) && !/Price:/i.test(formatted)) {
                formatted = formatted.replace(/(Selling or trading.*?)(\.|$)/i, '$1 Price: Negotiable.$2');
            }
            
            // Add dollar signs to prices
            formatted = formatted.replace(/(Price:|Budget:)\s*(\d+[.,]?\d*)/gi, '$1 $$2');
            formatted = formatted.replace(/(\$\s*)(\d+[.,]?\d*)\s*(Million|million)/gi, '$$2 $3');
            
            // Ensure proper ending punctuation
            if (!/[.!?]$/.test(formatted)) {
                if (/\d$/.test(formatted)) {
                    // No period needed if ending with number
                } else {
                    formatted += '.';
                }
            }
            
            // Category-specific formatting
            if (category === 'Auto') {
                // Add quotes around vehicle names
                vehicleDatabase.forEach(vehicle => {
                    const regex = new RegExp(`\\b${vehicle.replace(/[.*+?^${}()|[\]\\]/g, '\\$&')}\\b`, 'gi');
                    formatted = formatted.replace(regex, `"${vehicle}"`);
                });
            }
            
            if (category === 'Real Estate') {
                // Replace "casino apartment" with "casino penthouse"
                formatted = formatted.replace(/casino apartment/gi, 'Casino penthouse');
                
                // Format garage spaces
                formatted = formatted.replace(/(\d+)\s*garage/gi, '$1 g.s.');
                formatted = formatted.replace(/(\d+)\s*warehouse/gi, '$1 w.h.');
            }
            
            return formatted;
        }
        
        function analyzeAd(text) {
            let analysis = "=== AD ANALYSIS ===\n\n";
            
            // Check starting phrase
            if (/^(Buying|Selling|Trading|Selling or trading|Looking for|Hiring|Renting)/i.test(text)) {
                analysis += "✅ Proper starting phrase\n";
            } else {
                analysis += "❌ Missing proper starting phrase (should begin with: Buying, Selling, Trading, etc.)\n";
            }
            
            // Check price/budget format
            if ((/Buying/i.test(text) && /Budget:/i.test(text)) || 
                ((/Selling/i.test(text) || /Selling or trading/i.test(text)) && /Price:/i.test(text))) {
                analysis += "✅ Proper price/budget format\n";
            } else {
                analysis += "❌ Missing price/budget information\n";
            }
            
            // Check capitalization
            if (/^[A-Z]/.test(text)) {
                analysis += "✅ Proper capitalization\n";
            } else {
                analysis += "❌ First letter should be capitalized\n";
            }
            
            // Check ending punctuation
            if (/[.!?]$/.test(text) || /\d$/.test(text)) {
                analysis += "✅ Proper ending punctuation\n";
            } else {
                analysis += "❌ Missing ending punctuation\n";
            }
            
            // Check for illegal content
            let hasIllegalContent = false;
            for (const item of illegalItems) {
                if (text.toLowerCase().includes(item)) {
                    analysis += `❌ Contains prohibited content: ${item}\n`;
                    hasIllegalContent = true;
                }
            }
            
            if (!hasIllegalContent) {
                analysis += "✅ No illegal/prohibited content detected\n";
            }
            
            // Vehicle count check
            const vehicleCount = (text.toLowerCase().match(/\b(car|vehicle|motorcycle|bike|boat|plane|helicopter)\b/g) || []).length;
            if (vehicleCount > 1 && !text.toLowerCase().includes('trading')) {
                analysis += `❌ Too many vehicles (${vehicleCount}), max 1 allowed\n`;
            } else if (vehicleCount > 0) {
                analysis += `✅ Vehicle count OK (${vehicleCount})\n`;
            }
            
            analysis += "\n=== SUGGESTED IMPROVEMENTS ===\n";
            
            // Suggest improvements based on common issues
            if (text.toLowerCase().includes('k') && !text.includes('.')) {
                analysis += "- Convert 'k' to proper format (e.g., 1k → 1.000)\n";
            }
            
            if (text.toLowerCase().includes('m') && !text.includes('Million')) {
                analysis += "- Convert 'm' to 'Million' (e.g., 1m → 1 Million)\n";
            }
            
            if (text.includes('extras')) {
                analysis += "- Change 'extras' to 'of type'\n";
            }
            
            if (text.includes('crates') || text.includes('cases')) {
                analysis += "- Change 'crates/cases' to 'containers'\n";
            }
            
            if (text.includes('looking to buy')) {
                analysis += "- Change 'looking to buy' to 'Buying'\n";
            }
            
            return analysis;
        }
    </script>
</body>
</html>
    <title>LifeInvader Ad Formatter</title>
    <style>
        :root {
            --bg-primary: #1a1a1a;
            --bg-secondary: #2d2d2d;
            --bg-tertiary: #3d3d3d;
            --text-primary: #e0e0e0;
            --text-secondary: #a0a0a0;
            --accent: #4a76cf;
            --accent-hover: #5a86df;
            --success: #4caf50;
            --warning: #ff9800;
            --danger: #f44336;
            --border: #444;
        }

        .light-mode {
            --bg-primary: #f5f5f5;
            --bg-secondary: #e0e0e0;
            --bg-tertiary: #d0d0d0;
            --text-primary: #333;
            --text-secondary: #666;
            --accent: #3f51b5;
            --accent-hover: #303f9f;
            --success: #4caf50;
            --warning: #ff9800;
            --danger: #f44336;
            --border: #ccc;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: var(--bg-primary);
            color: var(--text-primary);
            transition: background-color 0.3s, color 0.3s;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border);
        }

        h1 {
            font-size: 28px;
            color: var(--accent);
        }

        .theme-toggle {
            background: var(--bg-tertiary);
            border: none;
            color: var(--text-primary);
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .theme-toggle:hover {
            background: var(--accent);
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }

        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }

        .input-section, .output-section {
            background: var(--bg-secondary);
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        h2 {
            margin-bottom: 15px;
            font-size: 22px;
            color: var(--accent);
        }

        textarea {
            width: 100%;
            height: 200px;
            background: var(--bg-primary);
            color: var(--text-primary);
            border: 1px solid var(--border);
            border-radius: 5px;
            padding: 15px;
            resize: vertical;
            font-size: 16px;
        }

        .button-group {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        button {
            background: var(--accent);
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 600;
            transition: background 0.2s;
        }

        button:hover {
            background: var(--accent-hover);
        }

        button.secondary {
            background: var(--bg-tertiary);
            color: var(--text-primary);
        }

        button.secondary:hover {
            background: var(--border);
        }

        .output-container {
            background: var(--bg-primary);
            border: 1px solid var(--border);
            border-radius: 5px;
            padding: 15px;
            min-height: 200px;
            white-space: pre-wrap;
            font-size: 16px;
            line-height: 1.5;
        }

        .rejection-reason {
            color: var(--danger);
            font-weight: bold;
            margin-top: 10px;
        }

        .settings-section {
            margin-top: 30px;
            background: var(--bg-secondary);
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .settings-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .settings-item {
            margin-bottom: 15px;
        }

        .settings-item label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
        }

        .settings-item input, .settings-item select {
            width: 100%;
            padding: 8px 10px;
            background: var(--bg-primary);
            color: var(--text-primary);
            border: 1px solid var(--border);
            border-radius: 5px;
        }

        .custom-items {
            margin-top: 20px;
        }

        .custom-items-list {
            max-height: 200px;
            overflow-y: auto;
            margin-top: 10px;
            padding: 10px;
            background: var(--bg-primary);
            border-radius: 5px;
            border: 1px solid var(--border);
        }

        .custom-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px;
            border-bottom: 1px solid var(--border);
        }

        .custom-item:last-child {
            border-bottom: none;
        }

        .delete-item {
            color: var(--danger);
            cursor: pointer;
            font-weight: bold;
        }

        .tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 1px solid var(--border);
        }

        .tab {
            padding: 10px 20px;
            cursor: pointer;
            border-bottom: 2px solid transparent;
        }

        .tab.active {
            border-bottom: 2px solid var(--accent);
            color: var(--accent);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .quick-templates {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 10px;
            margin-top: 15px;
        }

        .template-btn {
            background: var(--bg-tertiary);
            color: var(--text-primary);
            border: none;
            padding: 8px 12px;
            border-radius: 5px;
            cursor: pointer;
            text-align: left;
            transition: background 0.2s;
        }

        .template-btn:hover {
            background: var(--accent);
            color: white;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>LifeInvader Ad Formatter</h1>
            <button class="theme-toggle" id="themeToggle">
                <span id="themeIcon">☀️</span>
                <span id="themeText">Light Mode</span>
            </button>
        </header>

        <div class="tabs">
            <div class="tab active" data-tab="formatter">Ad Formatter</div>
            <div class="tab" data-tab="settings">Settings</div>
            <div class="tab" data-tab="help">Help</div>
        </div>

        <div class="tab-content active" id="formatter">
            <div class="main-content">
                <div class="input-section">
                    <h2>Input Raw Ad</h2>
                    <textarea id="rawAd" placeholder="Paste your raw ad here..."></textarea>
                    
                    <div class="button-group">
                        <button id="formatBtn">Format Ad</button>
                        <button id="clearBtn" class="secondary">Clear</button>
                    </div>

                    <div class="quick-templates">
                        <button class="template-btn" data-template="buying">Buying Template</button>
                        <button class="template-btn" data-template="selling">Selling Template</button>
                        <button class="template-btn" data-template="trading">Trading Template</button>
                        <button class="template-btn" data-template="renting">Renting Template</button>
                        <button class="template-btn" data-template="looking">Looking For Template</button>
                    </div>
                </div>

                <div class="output-section">
                    <h2>Formatted Ad</h2>
                    <div class="output-container" id="formattedAd">
                        Your formatted ad will appear here...
                    </div>
                    <div class="button-group">
                        <button id="copyBtn">Copy to Clipboard</button>
                    </div>
                    <div id="rejectionReason" class="rejection-reason"></div>
                </div>
            </div>
        </div>

        <div class="tab-content" id="settings">
            <div class="settings-section">
                <h2>Settings</h2>
                <div class="settings-grid">
                    <div class="settings-item">
                        <label for="priceFormat">Price Format</label>
                        <select id="priceFormat">
                            <option value="standard">Standard ($1.000)</option>
                            <option value="compact">Compact ($1k)</option>
                        </select>
                    </div>
                    <div class="settings-item">
                        <label for="autoCapitalize">Auto Capitalize</label>
                        <select id="autoCapitalize">
                            <option value="yes">Yes</option>
                            <option value="no">No</option>
                        </select>
                    </div>
                    <div class="settings-item">
                        <label for="defaultCategory">Default Category</label>
                        <select id="defaultCategory">
                            <option value="auto">Auto-detect</option>
                            <option value="realEstate">Real Estate</option>
                            <option value="auto">Auto</option>
                            <option value="business">Business</option>
                            <option value="work">Work</option>
                            <option value="dating">Dating</option>
                            <option value="services">Services</option>
                            <option value="discounts">Discounts</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <div class="settings-item">
                        <label for="rejectionStrictness">Rejection Strictness</label>
                        <select id="rejectionStrictness">
                            <option value="strict">Strict</option>
                            <option value="moderate">Moderate</option>
                            <option value="lenient">Lenient</option>
                        </select>
                    </div>
                </div>

                <div class="custom-items">
                    <h3>Custom Items</h3>
                    <div class="settings-item">
                        <label for="newItem">Add New Item</label>
                        <input type="text" id="newItem" placeholder="Enter item name...">
                        <button id="addItemBtn" style="margin-top: 10px;">Add Item</button>
                    </div>
                    <div class="custom-items-list" id="customItemsList">
                        <!-- Custom items will be listed here -->
                    </div>
                </div>
            </div>
        </div>

        <div class="tab-content" id="help">
            <div class="settings-section">
                <h2>Help & Instructions</h2>
                <h3>How to Use</h3>
                <p>1. Paste your raw ad in the input field</p>
                <p>2. Click "Format Ad" to process the ad according to LifeInvader policies</p>
                <p>3. Copy the formatted ad using the "Copy to Clipboard" button</p>
                
                <h3>Key Rules</h3>
                <p>- Always begin with: "Buying", "Selling", "Trading", or "Selling or trading"</p>
                <p>- Use "Budget:" for buying ads and "Price:" for selling ads</p>
                <p>- Use "Negotiable" if no price/budget is specified</p>
                <p>- Always capitalize the first letter and end with a period (unless ending with a number)</p>
                <p>- Use proper formatting for prices: $1.000 instead of $1k, $1 Million instead of $1m</p>
                
                <h3>Common Terms to Change</h3>
                <p>- "Looking to buy" → "Buying"</p>
                <p>- "Max config" → "with full configuration"</p>
                <p>- "Body upgrades" → "with visual upgrades"</p>
                <p>- "Extras" → "of type"</p>
                <p>- "Crates/cases" → "containers"</p>
                
                <h3>Rejection Reasons</h3>
                <p>The tool will flag ads that:</p>
                <p>- Contain illegal items (firearms, drugs, etc.)</p>
                <p>- Advertise more than 1 vehicle or 3 items</p>
                <p>- Have insufficient information</p>
                <p>- Contain prohibited content</p>
            </div>
        </div>
    </div>

    <script>
        // Theme toggle functionality
        const themeToggle = document.getElementById('themeToggle');
        const themeIcon = document.getElementById('themeIcon');
        const themeText = document.getElementById('themeText');
        
        themeToggle.addEventListener('click', () => {
            document.body.classList.toggle('light-mode');
            if (document.body.classList.contains('light-mode')) {
                themeIcon.textContent = '🌙';
                themeText.textContent = 'Dark Mode';
            } else {
                themeIcon.textContent = '☀️';
                themeText.textContent = 'Light Mode';
            }
        });

        // Tab functionality
        const tabs = document.querySelectorAll('.tab');
        const tabContents = document.querySelectorAll('.tab-content');
        
        tabs.forEach(tab => {
            tab.addEventListener('click', () => {
                const tabId = tab.getAttribute('data-tab');
                
                // Remove active class from all tabs and contents
                tabs.forEach(t => t.classList.remove('active'));
                tabContents.forEach(c => c.classList.remove('active'));
                
                // Add active class to clicked tab and corresponding content
                tab.classList.add('active');
                document.getElementById(tabId).classList.add('active');
            });
        });

        // Template buttons
        const templateButtons = document.querySelectorAll('.template-btn');
        const rawAdTextarea = document.getElementById('rawAd');
        
        templateButtons.forEach(button => {
            button.addEventListener('click', () => {
                const templateType = button.getAttribute('data-template');
                let templateText = '';
                
                switch(templateType) {
                    case 'buying':
                        templateText = 'Looking to buy a car. Budget: $500.000';
                        break;
                    case 'selling':
                        templateText = 'Selling my car. Price: $1.000.000';
                        break;
                    case 'trading':
                        templateText = 'Trading my car for another car.';
                        break;
                    case 'renting':
                        templateText = 'Renting out my house. Rent: $100.000 per week';
                        break;
                    case 'looking':
                        templateText = 'Looking for a job.';
                        break;
                }
                
                rawAdTextarea.value = templateText;
            });
        });

        // Format button functionality
        const formatBtn = document.getElementById('formatBtn');
        const clearBtn = document.getElementById('clearBtn');
        const copyBtn = document.getElementById('copyBtn');
        const formattedAd = document.getElementById('formattedAd');
        const rejectionReason = document.getElementById('rejectionReason');
        
        formatBtn.addEventListener('click', () => {
            const rawText = rawAdTextarea.value.trim();
            
            if (!rawText) {
                formattedAd.textContent = 'Please enter an ad to format.';
                rejectionReason.textContent = '';
                return;
            }
            
            // Process the ad
            const result = processAd(rawText);
            formattedAd.textContent = result.formattedAd;
            
            if (result.rejection) {
                rejectionReason.textContent = `Rejection Reason: ${result.rejection}`;
            } else {
                rejectionReason.textContent = '';
            }
        });
        
        clearBtn.addEventListener('click', () => {
            rawAdTextarea.value = '';
            formattedAd.textContent = 'Your formatted ad will appear here...';
            rejectionReason.textContent = '';
        });
        
        copyBtn.addEventListener('click', () => {
            const textToCopy = formattedAd.textContent;
            navigator.clipboard.writeText(textToCopy).then(() => {
                // Show temporary feedback
                const originalText = copyBtn.textContent;
                copyBtn.textContent = 'Copied!';
                setTimeout(() => {
                    copyBtn.textContent = originalText;
                }, 2000);
            });
        });

        // Custom items functionality
        const addItemBtn = document.getElementById('addItemBtn');
        const newItemInput = document.getElementById('newItem');
        const customItemsList = document.getElementById('customItemsList');
        
        // Load custom items from localStorage
        let customItems = JSON.parse(localStorage.getItem('lifeinvaderCustomItems')) || [];
        renderCustomItems();
        
        addItemBtn.addEventListener('click', () => {
            const itemName = newItemInput.value.trim();
            if (itemName && !customItems.includes(itemName)) {
                customItems.push(itemName);
                localStorage.setItem('lifeinvaderCustomItems', JSON.stringify(customItems));
                renderCustomItems();
                newItemInput.value = '';
            }
        });
        
        function renderCustomItems() {
            customItemsList.innerHTML = '';
            customItems.forEach((item, index) => {
                const itemElement = document.createElement('div');
                itemElement.className = 'custom-item';
                itemElement.innerHTML = `
                    <span>${item}</span>
                    <span class="delete-item" data-index="${index}">×</span>
                `;
                customItemsList.appendChild(itemElement);
            });
            
            // Add event listeners to delete buttons
            document.querySelectorAll('.delete-item').forEach(button => {
                button.addEventListener('click', (e) => {
                    const index = parseInt(e.target.getAttribute('data-index'));
                    customItems.splice(index, 1);
                    localStorage.setItem('lifeinvaderCustomItems', JSON.stringify(customItems));
                    renderCustomItems();
                });
            });
        }

        // Ad processing function (simplified version)
        function processAd(rawText) {
            // This is a simplified version - a full implementation would be much more complex
            let formatted = rawText;
            let rejection = null;
            
            // Check for illegal items
            const illegalItems = [
                'firearm', 'gun', 'ammo', 'bullet', 'weed', 'cocaine', 'drug',
                'balaclava', 'rope', 'head bag', 'virus', 'lock pick', 'crowbar',
                'covid mask', 'bandit mask', 'animal skin', 'satellite dish',
                'barricade', 'anti-radar', 'engine block', 'air horn'
            ];
            
            for (const item of illegalItems) {
                if (rawText.toLowerCase().includes(item)) {
                    rejection = 'Cannot promote illegal items.';
                    break;
                }
            }
            
            // Check for multiple vehicles
            const vehicleKeywords = ['car', 'vehicle', 'motorcycle', 'bike', 'boat', 'plane', 'helicopter'];
            let vehicleCount = 0;
            
            vehicleKeywords.forEach(keyword => {
                const regex = new RegExp(`\\b${keyword}\\b`, 'gi');
                const matches = rawText.match(regex);
                if (matches) vehicleCount += matches.length;
            });
            
            if (vehicleCount > 1 && !rawText.toLowerCase().includes('trading')) {
                rejection = 'Cannot advertise more than 1 vehicle at a time.';
            }
            
            // Basic formatting
            if (!rejection) {
                // Capitalize first letter
                formatted = formatted.charAt(0).toUpperCase() + formatted.slice(1);
                
                // Replace common terms
                const replacements = [
                    { from: /\blooking to buy\b/gi, to: 'Buying' },
                    { from: /\blooking to purchase\b/gi, to: 'Buying' },
                    { from: /\bmax config\b/gi, to: 'with full configuration' },
                    { from: /\bmax tuning\b/gi, to: 'with full configuration' },
                    { from: /\bfully upgraded\b/gi, to: 'with full configuration' },
                    { from: /\bnearly max\b/gi, to: 'with partial configuration' },
                    { from: /\bpartly upgraded\b/gi, to: 'with partial configuration' },
                    { from: /\bbody upgrades\b/gi, to: 'with visual upgrades' },
                    { from: /\bbody kit\b/gi, to: 'with visual upgrades' },
                    { from: /\bturbo\b/gi, to: 'turbo kit' },
                    { from: /\bdrift tuning\b/gi, to: 'drift kit' },
                    { from: /\bdrift assistance\b/gi, to: 'drift kit' },
                    { from: /\bluminous rims\b/gi, to: 'luminous wheels' },
                    { from: /\bunique wheels\b/gi, to: 'luminous wheels' },
                    { from: /\bcrates\b/gi, to: 'containers' },
                    { from: /\bcases\b/gi, to: 'containers' },
                    { from: /\bextras\b/gi, to: 'of type' },
                    { from: /\bspray cans\b/gi, to: 'paint cans' },
                    { from: /\bspray balloons\b/gi, to: 'paint cans' },
                    { from: /(\d)k\b/gi, to: '$1.000' },
                    { from: /(\d)\.(\d)k\b/gi, to: '$1.$200' },
                    { from: /(\d)m\b/gi, to: '$1 Million' },
                    { from: /(\d)\.(\d)m\b/gi, to: '$1.$2 Million' },
                ];
                
                replacements.forEach(rep => {
                    formatted = formatted.replace(rep.from, rep.to);
                });
                
                // Ensure proper ending punctuation
                if (!/[.!?]$/.test(formatted)) {
                    // If ends with a number, don't add period
                    if (/\d$/.test(formatted)) {
                        // No period needed
                    } else {
                        formatted += '.';
                    }
                }
                
                // Ensure proper price/budget format
                if (formatted.toLowerCase().includes('buying') && !formatted.toLowerCase().includes('budget:')) {
                    formatted = formatted.replace(/(buying.*?)(\.|$)/i, '$1 Budget: Negotiable.$2');
                }
                
                if (formatted.toLowerCase().includes('selling') && !formatted.toLowerCase().includes('price:')) {
                    formatted = formatted.replace(/(selling.*?)(\.|$)/i, '$1 Price: Negotiable.$2');
                }
                
                // Add dollar signs to prices
                formatted = formatted.replace(/(price:|budget:)\s*(\d+[.,]?\d*)/gi, '$1 $$2');
            }
            
            return {
                formattedAd: rejection ? 'AD REJECTED' : formatted,
                rejection: rejection
            };
        }
    </script>
</body>
</html>
